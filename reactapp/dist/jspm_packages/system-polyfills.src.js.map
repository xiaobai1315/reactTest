{"version":3,"sources":["../../jspm_packages/system-polyfills.src.js"],"names":["define","e","exports","module","amd","window","Promise","global","self","t","n","r","s","o","u","a","require","i","Error","f","call","length","unhandledRejections","PromiseConstructor","makePromise","Scheduler","async","asap","scheduler","factory","_async","_running","_queue","_queueLen","_afterQueue","_afterQueueLen","drain","_drain","prototype","enqueue","task","run","afterQueue","setTimer","format","unhandledRejection","logError","noop","logInfo","localConsole","console","error","log","info","onPotentiallyUnhandledRejection","rejection","report","onPotentiallyUnhandledRejectionHandled","unreport","onFatalRejection","throwit","value","tasks","reported","running","handled","push","id","formatError","indexOf","splice","formatObject","x","flush","shift","MutationObs","capturedSetTimeout","setTimeout","ms","clearTimer","clearTimeout","isNode","process","nextTick","hasMutationObserver","initMutationObserver","vertxRequire","vertx","cancelTimer","runOnLoop","runOnContext","Object","toString","MutationObserver","WebKitMutationObserver","scheduled","node","document","createTextNode","observe","characterData","data","tryStringify","stack","message","String","JSON","defaultValue","stringify","environment","emitRejection","initEmitRejection","objectCreate","create","proto","Child","resolver","handler","_handler","Handler","init","Pending","promiseResolve","promiseReject","promiseNotify","resolve","reason","reject","notify","never","_defer","defer","getHandler","isPromise","Async","Rejected","foreverPendingPromise","then","onFulfilled","onRejected","onProgress","parent","state","join","constructor","p","_beget","child","chain","receiver","begetFrom","context","all","race","_traverse","traverse","promises","traverseWith","snd","tryCatch2","tryMap","mapAt","settleAt","pending","results","Array","resolved","traverseAt","become","Fulfilled","maybeThenable","h","getHandlerMaybeThenable","fold","visitRemaining","_visitRemaining","start","markAsHandled","visit","_unreport","TypeError","runRace","getHandlerUntrusted","untrustedThen","Thenable","when","fail","_report","_state","to","fulfilled","rejected","progress","failIfRejected","z","c","Fold","FailIfRejected","inherit","inheritedContext","createContext","consumers","cycle","q","continuation","ContinuationTask","ProgressTask","thenable","AssimilateTask","runContinuation3","cont","runContinuation1","errorId","ReportTask","UnreportTask","enterContext","exitContext","foreverPendingHandler","runNotify","_then","tryAssimilate","_resolve","_reject","_notify","next","tryCatchReject","tryCatchReject3","tryCatchReturn","b","thisArg","y","Parent","emit","type","CustomEvent","hasCustomEvent","ev","detail","key","bubbles","cancelable","dispatchEvent","systemJSBootstrap"],"mappings":"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","file":"system-polyfills.src.js","sourcesContent":["/*\n * SystemJS Promise Polyfill\n */\n(function(define) {\n\n!function(e){\"object\"==typeof exports?module.exports=e():\"function\"==typeof define&&define.amd?define(e):\"undefined\"!=typeof window?window.Promise=e():\"undefined\"!=typeof global?global.Promise=e():\"undefined\"!=typeof self&&(self.Promise=e())}(function(){var define,module,exports;return (function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);throw new Error(\"Cannot find module '\"+o+\"'\")}var f=n[o]={exports:{}};t[o][0].call(f.exports,function(e){var n=t[o][1][e];return s(n?n:e)},f,f.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){\n/** @license MIT License (c) copyright 2010-2014 original author or authors */\n/** @author Brian Cavalier */\n/** @author John Hann */\n\n/**\n * ES6 global Promise shim\n */\nvar unhandledRejections = require('../lib/decorators/unhandledRejection');\nvar PromiseConstructor = unhandledRejections(require('../lib/Promise'));\n\nmodule.exports = typeof global != 'undefined' ? (global.Promise = PromiseConstructor)\n\t           : typeof self   != 'undefined' ? (self.Promise   = PromiseConstructor)\n\t           : PromiseConstructor;\n\n},{\"../lib/Promise\":2,\"../lib/decorators/unhandledRejection\":4}],2:[function(require,module,exports){\n/** @license MIT License (c) copyright 2010-2014 original author or authors */\n/** @author Brian Cavalier */\n/** @author John Hann */\n\n(function(define) { 'use strict';\ndefine(function (require) {\n\n\tvar makePromise = require('./makePromise');\n\tvar Scheduler = require('./Scheduler');\n\tvar async = require('./env').asap;\n\n\treturn makePromise({\n\t\tscheduler: new Scheduler(async)\n\t});\n\n});\n})(typeof define === 'function' && define.amd ? define : function (factory) { module.exports = factory(require); });\n\n},{\"./Scheduler\":3,\"./env\":5,\"./makePromise\":7}],3:[function(require,module,exports){\n/** @license MIT License (c) copyright 2010-2014 original author or authors */\n/** @author Brian Cavalier */\n/** @author John Hann */\n\n(function(define) { 'use strict';\ndefine(function() {\n\n\t// Credit to Twisol (https://github.com/Twisol) for suggesting\n\t// this type of extensible queue + trampoline approach for next-tick conflation.\n\n\t/**\n\t * Async task scheduler\n\t * @param {function} async function to schedule a single async function\n\t * @constructor\n\t */\n\tfunction Scheduler(async) {\n\t\tthis._async = async;\n\t\tthis._running = false;\n\n\t\tthis._queue = this;\n\t\tthis._queueLen = 0;\n\t\tthis._afterQueue = {};\n\t\tthis._afterQueueLen = 0;\n\n\t\tvar self = this;\n\t\tthis.drain = function() {\n\t\t\tself._drain();\n\t\t};\n\t}\n\n\t/**\n\t * Enqueue a task\n\t * @param {{ run:function }} task\n\t */\n\tScheduler.prototype.enqueue = function(task) {\n\t\tthis._queue[this._queueLen++] = task;\n\t\tthis.run();\n\t};\n\n\t/**\n\t * Enqueue a task to run after the main task queue\n\t * @param {{ run:function }} task\n\t */\n\tScheduler.prototype.afterQueue = function(task) {\n\t\tthis._afterQueue[this._afterQueueLen++] = task;\n\t\tthis.run();\n\t};\n\n\tScheduler.prototype.run = function() {\n\t\tif (!this._running) {\n\t\t\tthis._running = true;\n\t\t\tthis._async(this.drain);\n\t\t}\n\t};\n\n\t/**\n\t * Drain the handler queue entirely, and then the after queue\n\t */\n\tScheduler.prototype._drain = function() {\n\t\tvar i = 0;\n\t\tfor (; i < this._queueLen; ++i) {\n\t\t\tthis._queue[i].run();\n\t\t\tthis._queue[i] = void 0;\n\t\t}\n\n\t\tthis._queueLen = 0;\n\t\tthis._running = false;\n\n\t\tfor (i = 0; i < this._afterQueueLen; ++i) {\n\t\t\tthis._afterQueue[i].run();\n\t\t\tthis._afterQueue[i] = void 0;\n\t\t}\n\n\t\tthis._afterQueueLen = 0;\n\t};\n\n\treturn Scheduler;\n\n});\n}(typeof define === 'function' && define.amd ? define : function(factory) { module.exports = factory(); }));\n\n},{}],4:[function(require,module,exports){\n/** @license MIT License (c) copyright 2010-2014 original author or authors */\n/** @author Brian Cavalier */\n/** @author John Hann */\n\n(function(define) { 'use strict';\ndefine(function(require) {\n\n\tvar setTimer = require('../env').setTimer;\n\tvar format = require('../format');\n\n\treturn function unhandledRejection(Promise) {\n\n\t\tvar logError = noop;\n\t\tvar logInfo = noop;\n\t\tvar localConsole;\n\n\t\tif(typeof console !== 'undefined') {\n\t\t\t// Alias console to prevent things like uglify's drop_console option from\n\t\t\t// removing console.log/error. Unhandled rejections fall into the same\n\t\t\t// category as uncaught exceptions, and build tools shouldn't silence them.\n\t\t\tlocalConsole = console;\n\t\t\tlogError = typeof localConsole.error !== 'undefined'\n\t\t\t\t? function (e) { localConsole.error(e); }\n\t\t\t\t: function (e) { localConsole.log(e); };\n\n\t\t\tlogInfo = typeof localConsole.info !== 'undefined'\n\t\t\t\t? function (e) { localConsole.info(e); }\n\t\t\t\t: function (e) { localConsole.log(e); };\n\t\t}\n\n\t\tPromise.onPotentiallyUnhandledRejection = function(rejection) {\n\t\t\tenqueue(report, rejection);\n\t\t};\n\n\t\tPromise.onPotentiallyUnhandledRejectionHandled = function(rejection) {\n\t\t\tenqueue(unreport, rejection);\n\t\t};\n\n\t\tPromise.onFatalRejection = function(rejection) {\n\t\t\tenqueue(throwit, rejection.value);\n\t\t};\n\n\t\tvar tasks = [];\n\t\tvar reported = [];\n\t\tvar running = null;\n\n\t\tfunction report(r) {\n\t\t\tif(!r.handled) {\n\t\t\t\treported.push(r);\n\t\t\t\tlogError('Potentially unhandled rejection [' + r.id + '] ' + format.formatError(r.value));\n\t\t\t}\n\t\t}\n\n\t\tfunction unreport(r) {\n\t\t\tvar i = reported.indexOf(r);\n\t\t\tif(i >= 0) {\n\t\t\t\treported.splice(i, 1);\n\t\t\t\tlogInfo('Handled previous rejection [' + r.id + '] ' + format.formatObject(r.value));\n\t\t\t}\n\t\t}\n\n\t\tfunction enqueue(f, x) {\n\t\t\ttasks.push(f, x);\n\t\t\tif(running === null) {\n\t\t\t\trunning = setTimer(flush, 0);\n\t\t\t}\n\t\t}\n\n\t\tfunction flush() {\n\t\t\trunning = null;\n\t\t\twhile(tasks.length > 0) {\n\t\t\t\ttasks.shift()(tasks.shift());\n\t\t\t}\n\t\t}\n\n\t\treturn Promise;\n\t};\n\n\tfunction throwit(e) {\n\t\tthrow e;\n\t}\n\n\tfunction noop() {}\n\n});\n}(typeof define === 'function' && define.amd ? define : function(factory) { module.exports = factory(require); }));\n\n},{\"../env\":5,\"../format\":6}],5:[function(require,module,exports){\n/** @license MIT License (c) copyright 2010-2014 original author or authors */\n/** @author Brian Cavalier */\n/** @author John Hann */\n\n/*global process,document,setTimeout,clearTimeout,MutationObserver,WebKitMutationObserver*/\n(function(define) { 'use strict';\ndefine(function(require) {\n\t/*jshint maxcomplexity:6*/\n\n\t// Sniff \"best\" async scheduling option\n\t// Prefer process.nextTick or MutationObserver, then check for\n\t// setTimeout, and finally vertx, since its the only env that doesn't\n\t// have setTimeout\n\n\tvar MutationObs;\n\tvar capturedSetTimeout = typeof setTimeout !== 'undefined' && setTimeout;\n\n\t// Default env\n\tvar setTimer = function(f, ms) { return setTimeout(f, ms); };\n\tvar clearTimer = function(t) { return clearTimeout(t); };\n\tvar asap = function (f) { return capturedSetTimeout(f, 0); };\n\n\t// Detect specific env\n\tif (isNode()) { // Node\n\t\tasap = function (f) { return process.nextTick(f); };\n\n\t} else if (MutationObs = hasMutationObserver()) { // Modern browser\n\t\tasap = initMutationObserver(MutationObs);\n\n\t} else if (!capturedSetTimeout) { // vert.x\n\t\tvar vertxRequire = require;\n\t\tvar vertx = vertxRequire('vertx');\n\t\tsetTimer = function (f, ms) { return vertx.setTimer(ms, f); };\n\t\tclearTimer = vertx.cancelTimer;\n\t\tasap = vertx.runOnLoop || vertx.runOnContext;\n\t}\n\n\treturn {\n\t\tsetTimer: setTimer,\n\t\tclearTimer: clearTimer,\n\t\tasap: asap\n\t};\n\n\tfunction isNode () {\n\t\treturn typeof process !== 'undefined' &&\n\t\t\tObject.prototype.toString.call(process) === '[object process]';\n\t}\n\n\tfunction hasMutationObserver () {\n\t\treturn (typeof MutationObserver === 'function' && MutationObserver) ||\n\t\t\t(typeof WebKitMutationObserver === 'function' && WebKitMutationObserver);\n\t}\n\n\tfunction initMutationObserver(MutationObserver) {\n\t\tvar scheduled;\n\t\tvar node = document.createTextNode('');\n\t\tvar o = new MutationObserver(run);\n\t\to.observe(node, { characterData: true });\n\n\t\tfunction run() {\n\t\t\tvar f = scheduled;\n\t\t\tscheduled = void 0;\n\t\t\tf();\n\t\t}\n\n\t\tvar i = 0;\n\t\treturn function (f) {\n\t\t\tscheduled = f;\n\t\t\tnode.data = (i ^= 1);\n\t\t};\n\t}\n});\n}(typeof define === 'function' && define.amd ? define : function(factory) { module.exports = factory(require); }));\n\n},{}],6:[function(require,module,exports){\n/** @license MIT License (c) copyright 2010-2014 original author or authors */\n/** @author Brian Cavalier */\n/** @author John Hann */\n\n(function(define) { 'use strict';\ndefine(function() {\n\n\treturn {\n\t\tformatError: formatError,\n\t\tformatObject: formatObject,\n\t\ttryStringify: tryStringify\n\t};\n\n\t/**\n\t * Format an error into a string.  If e is an Error and has a stack property,\n\t * it's returned.  Otherwise, e is formatted using formatObject, with a\n\t * warning added about e not being a proper Error.\n\t * @param {*} e\n\t * @returns {String} formatted string, suitable for output to developers\n\t */\n\tfunction formatError(e) {\n\t\tvar s = typeof e === 'object' && e !== null && (e.stack || e.message) ? e.stack || e.message : formatObject(e);\n\t\treturn e instanceof Error ? s : s + ' (WARNING: non-Error used)';\n\t}\n\n\t/**\n\t * Format an object, detecting \"plain\" objects and running them through\n\t * JSON.stringify if possible.\n\t * @param {Object} o\n\t * @returns {string}\n\t */\n\tfunction formatObject(o) {\n\t\tvar s = String(o);\n\t\tif(s === '[object Object]' && typeof JSON !== 'undefined') {\n\t\t\ts = tryStringify(o, s);\n\t\t}\n\t\treturn s;\n\t}\n\n\t/**\n\t * Try to return the result of JSON.stringify(x).  If that fails, return\n\t * defaultValue\n\t * @param {*} x\n\t * @param {*} defaultValue\n\t * @returns {String|*} JSON.stringify(x) or defaultValue\n\t */\n\tfunction tryStringify(x, defaultValue) {\n\t\ttry {\n\t\t\treturn JSON.stringify(x);\n\t\t} catch(e) {\n\t\t\treturn defaultValue;\n\t\t}\n\t}\n\n});\n}(typeof define === 'function' && define.amd ? define : function(factory) { module.exports = factory(); }));\n\n},{}],7:[function(require,module,exports){\n/** @license MIT License (c) copyright 2010-2014 original author or authors */\n/** @author Brian Cavalier */\n/** @author John Hann */\n\n(function(define) { 'use strict';\ndefine(function() {\n\n\treturn function makePromise(environment) {\n\n\t\tvar tasks = environment.scheduler;\n\t\tvar emitRejection = initEmitRejection();\n\n\t\tvar objectCreate = Object.create ||\n\t\t\tfunction(proto) {\n\t\t\t\tfunction Child() {}\n\t\t\t\tChild.prototype = proto;\n\t\t\t\treturn new Child();\n\t\t\t};\n\n\t\t/**\n\t\t * Create a promise whose fate is determined by resolver\n\t\t * @constructor\n\t\t * @returns {Promise} promise\n\t\t * @name Promise\n\t\t */\n\t\tfunction Promise(resolver, handler) {\n\t\t\tthis._handler = resolver === Handler ? handler : init(resolver);\n\t\t}\n\n\t\t/**\n\t\t * Run the supplied resolver\n\t\t * @param resolver\n\t\t * @returns {Pending}\n\t\t */\n\t\tfunction init(resolver) {\n\t\t\tvar handler = new Pending();\n\n\t\t\ttry {\n\t\t\t\tresolver(promiseResolve, promiseReject, promiseNotify);\n\t\t\t} catch (e) {\n\t\t\t\tpromiseReject(e);\n\t\t\t}\n\n\t\t\treturn handler;\n\n\t\t\t/**\n\t\t\t * Transition from pre-resolution state to post-resolution state, notifying\n\t\t\t * all listeners of the ultimate fulfillment or rejection\n\t\t\t * @param {*} x resolution value\n\t\t\t */\n\t\t\tfunction promiseResolve (x) {\n\t\t\t\thandler.resolve(x);\n\t\t\t}\n\t\t\t/**\n\t\t\t * Reject this promise with reason, which will be used verbatim\n\t\t\t * @param {Error|*} reason rejection reason, strongly suggested\n\t\t\t *   to be an Error type\n\t\t\t */\n\t\t\tfunction promiseReject (reason) {\n\t\t\t\thandler.reject(reason);\n\t\t\t}\n\n\t\t\t/**\n\t\t\t * @deprecated\n\t\t\t * Issue a progress event, notifying all progress listeners\n\t\t\t * @param {*} x progress event payload to pass to all listeners\n\t\t\t */\n\t\t\tfunction promiseNotify (x) {\n\t\t\t\thandler.notify(x);\n\t\t\t}\n\t\t}\n\n\t\t// Creation\n\n\t\tPromise.resolve = resolve;\n\t\tPromise.reject = reject;\n\t\tPromise.never = never;\n\n\t\tPromise._defer = defer;\n\t\tPromise._handler = getHandler;\n\n\t\t/**\n\t\t * Returns a trusted promise. If x is already a trusted promise, it is\n\t\t * returned, otherwise returns a new trusted Promise which follows x.\n\t\t * @param  {*} x\n\t\t * @return {Promise} promise\n\t\t */\n\t\tfunction resolve(x) {\n\t\t\treturn isPromise(x) ? x\n\t\t\t\t: new Promise(Handler, new Async(getHandler(x)));\n\t\t}\n\n\t\t/**\n\t\t * Return a reject promise with x as its reason (x is used verbatim)\n\t\t * @param {*} x\n\t\t * @returns {Promise} rejected promise\n\t\t */\n\t\tfunction reject(x) {\n\t\t\treturn new Promise(Handler, new Async(new Rejected(x)));\n\t\t}\n\n\t\t/**\n\t\t * Return a promise that remains pending forever\n\t\t * @returns {Promise} forever-pending promise.\n\t\t */\n\t\tfunction never() {\n\t\t\treturn foreverPendingPromise; // Should be frozen\n\t\t}\n\n\t\t/**\n\t\t * Creates an internal {promise, resolver} pair\n\t\t * @private\n\t\t * @returns {Promise}\n\t\t */\n\t\tfunction defer() {\n\t\t\treturn new Promise(Handler, new Pending());\n\t\t}\n\n\t\t// Transformation and flow control\n\n\t\t/**\n\t\t * Transform this promise's fulfillment value, returning a new Promise\n\t\t * for the transformed result.  If the promise cannot be fulfilled, onRejected\n\t\t * is called with the reason.  onProgress *may* be called with updates toward\n\t\t * this promise's fulfillment.\n\t\t * @param {function=} onFulfilled fulfillment handler\n\t\t * @param {function=} onRejected rejection handler\n\t\t * @param {function=} onProgress @deprecated progress handler\n\t\t * @return {Promise} new promise\n\t\t */\n\t\tPromise.prototype.then = function(onFulfilled, onRejected, onProgress) {\n\t\t\tvar parent = this._handler;\n\t\t\tvar state = parent.join().state();\n\n\t\t\tif ((typeof onFulfilled !== 'function' && state > 0) ||\n\t\t\t\t(typeof onRejected !== 'function' && state < 0)) {\n\t\t\t\t// Short circuit: value will not change, simply share handler\n\t\t\t\treturn new this.constructor(Handler, parent);\n\t\t\t}\n\n\t\t\tvar p = this._beget();\n\t\t\tvar child = p._handler;\n\n\t\t\tparent.chain(child, parent.receiver, onFulfilled, onRejected, onProgress);\n\n\t\t\treturn p;\n\t\t};\n\n\t\t/**\n\t\t * If this promise cannot be fulfilled due to an error, call onRejected to\n\t\t * handle the error. Shortcut for .then(undefined, onRejected)\n\t\t * @param {function?} onRejected\n\t\t * @return {Promise}\n\t\t */\n\t\tPromise.prototype['catch'] = function(onRejected) {\n\t\t\treturn this.then(void 0, onRejected);\n\t\t};\n\n\t\t/**\n\t\t * Creates a new, pending promise of the same type as this promise\n\t\t * @private\n\t\t * @returns {Promise}\n\t\t */\n\t\tPromise.prototype._beget = function() {\n\t\t\treturn begetFrom(this._handler, this.constructor);\n\t\t};\n\n\t\tfunction begetFrom(parent, Promise) {\n\t\t\tvar child = new Pending(parent.receiver, parent.join().context);\n\t\t\treturn new Promise(Handler, child);\n\t\t}\n\n\t\t// Array combinators\n\n\t\tPromise.all = all;\n\t\tPromise.race = race;\n\t\tPromise._traverse = traverse;\n\n\t\t/**\n\t\t * Return a promise that will fulfill when all promises in the\n\t\t * input array have fulfilled, or will reject when one of the\n\t\t * promises rejects.\n\t\t * @param {array} promises array of promises\n\t\t * @returns {Promise} promise for array of fulfillment values\n\t\t */\n\t\tfunction all(promises) {\n\t\t\treturn traverseWith(snd, null, promises);\n\t\t}\n\n\t\t/**\n\t\t * Array<Promise<X>> -> Promise<Array<f(X)>>\n\t\t * @private\n\t\t * @param {function} f function to apply to each promise's value\n\t\t * @param {Array} promises array of promises\n\t\t * @returns {Promise} promise for transformed values\n\t\t */\n\t\tfunction traverse(f, promises) {\n\t\t\treturn traverseWith(tryCatch2, f, promises);\n\t\t}\n\n\t\tfunction traverseWith(tryMap, f, promises) {\n\t\t\tvar handler = typeof f === 'function' ? mapAt : settleAt;\n\n\t\t\tvar resolver = new Pending();\n\t\t\tvar pending = promises.length >>> 0;\n\t\t\tvar results = new Array(pending);\n\n\t\t\tfor (var i = 0, x; i < promises.length && !resolver.resolved; ++i) {\n\t\t\t\tx = promises[i];\n\n\t\t\t\tif (x === void 0 && !(i in promises)) {\n\t\t\t\t\t--pending;\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\n\t\t\t\ttraverseAt(promises, handler, i, x, resolver);\n\t\t\t}\n\n\t\t\tif(pending === 0) {\n\t\t\t\tresolver.become(new Fulfilled(results));\n\t\t\t}\n\n\t\t\treturn new Promise(Handler, resolver);\n\n\t\t\tfunction mapAt(i, x, resolver) {\n\t\t\t\tif(!resolver.resolved) {\n\t\t\t\t\ttraverseAt(promises, settleAt, i, tryMap(f, x, i), resolver);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tfunction settleAt(i, x, resolver) {\n\t\t\t\tresults[i] = x;\n\t\t\t\tif(--pending === 0) {\n\t\t\t\t\tresolver.become(new Fulfilled(results));\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tfunction traverseAt(promises, handler, i, x, resolver) {\n\t\t\tif (maybeThenable(x)) {\n\t\t\t\tvar h = getHandlerMaybeThenable(x);\n\t\t\t\tvar s = h.state();\n\n\t\t\t\tif (s === 0) {\n\t\t\t\t\th.fold(handler, i, void 0, resolver);\n\t\t\t\t} else if (s > 0) {\n\t\t\t\t\thandler(i, h.value, resolver);\n\t\t\t\t} else {\n\t\t\t\t\tresolver.become(h);\n\t\t\t\t\tvisitRemaining(promises, i+1, h);\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\thandler(i, x, resolver);\n\t\t\t}\n\t\t}\n\n\t\tPromise._visitRemaining = visitRemaining;\n\t\tfunction visitRemaining(promises, start, handler) {\n\t\t\tfor(var i=start; i<promises.length; ++i) {\n\t\t\t\tmarkAsHandled(getHandler(promises[i]), handler);\n\t\t\t}\n\t\t}\n\n\t\tfunction markAsHandled(h, handler) {\n\t\t\tif(h === handler) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tvar s = h.state();\n\t\t\tif(s === 0) {\n\t\t\t\th.visit(h, void 0, h._unreport);\n\t\t\t} else if(s < 0) {\n\t\t\t\th._unreport();\n\t\t\t}\n\t\t}\n\n\t\t/**\n\t\t * Fulfill-reject competitive race. Return a promise that will settle\n\t\t * to the same state as the earliest input promise to settle.\n\t\t *\n\t\t * WARNING: The ES6 Promise spec requires that race()ing an empty array\n\t\t * must return a promise that is pending forever.  This implementation\n\t\t * returns a singleton forever-pending promise, the same singleton that is\n\t\t * returned by Promise.never(), thus can be checked with ===\n\t\t *\n\t\t * @param {array} promises array of promises to race\n\t\t * @returns {Promise} if input is non-empty, a promise that will settle\n\t\t * to the same outcome as the earliest input promise to settle. if empty\n\t\t * is empty, returns a promise that will never settle.\n\t\t */\n\t\tfunction race(promises) {\n\t\t\tif(typeof promises !== 'object' || promises === null) {\n\t\t\t\treturn reject(new TypeError('non-iterable passed to race()'));\n\t\t\t}\n\n\t\t\t// Sigh, race([]) is untestable unless we return *something*\n\t\t\t// that is recognizable without calling .then() on it.\n\t\t\treturn promises.length === 0 ? never()\n\t\t\t\t : promises.length === 1 ? resolve(promises[0])\n\t\t\t\t : runRace(promises);\n\t\t}\n\n\t\tfunction runRace(promises) {\n\t\t\tvar resolver = new Pending();\n\t\t\tvar i, x, h;\n\t\t\tfor(i=0; i<promises.length; ++i) {\n\t\t\t\tx = promises[i];\n\t\t\t\tif (x === void 0 && !(i in promises)) {\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\n\t\t\t\th = getHandler(x);\n\t\t\t\tif(h.state() !== 0) {\n\t\t\t\t\tresolver.become(h);\n\t\t\t\t\tvisitRemaining(promises, i+1, h);\n\t\t\t\t\tbreak;\n\t\t\t\t} else {\n\t\t\t\t\th.visit(resolver, resolver.resolve, resolver.reject);\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn new Promise(Handler, resolver);\n\t\t}\n\n\t\t// Promise internals\n\t\t// Below this, everything is @private\n\n\t\t/**\n\t\t * Get an appropriate handler for x, without checking for cycles\n\t\t * @param {*} x\n\t\t * @returns {object} handler\n\t\t */\n\t\tfunction getHandler(x) {\n\t\t\tif(isPromise(x)) {\n\t\t\t\treturn x._handler.join();\n\t\t\t}\n\t\t\treturn maybeThenable(x) ? getHandlerUntrusted(x) : new Fulfilled(x);\n\t\t}\n\n\t\t/**\n\t\t * Get a handler for thenable x.\n\t\t * NOTE: You must only call this if maybeThenable(x) == true\n\t\t * @param {object|function|Promise} x\n\t\t * @returns {object} handler\n\t\t */\n\t\tfunction getHandlerMaybeThenable(x) {\n\t\t\treturn isPromise(x) ? x._handler.join() : getHandlerUntrusted(x);\n\t\t}\n\n\t\t/**\n\t\t * Get a handler for potentially untrusted thenable x\n\t\t * @param {*} x\n\t\t * @returns {object} handler\n\t\t */\n\t\tfunction getHandlerUntrusted(x) {\n\t\t\ttry {\n\t\t\t\tvar untrustedThen = x.then;\n\t\t\t\treturn typeof untrustedThen === 'function'\n\t\t\t\t\t? new Thenable(untrustedThen, x)\n\t\t\t\t\t: new Fulfilled(x);\n\t\t\t} catch(e) {\n\t\t\t\treturn new Rejected(e);\n\t\t\t}\n\t\t}\n\n\t\t/**\n\t\t * Handler for a promise that is pending forever\n\t\t * @constructor\n\t\t */\n\t\tfunction Handler() {}\n\n\t\tHandler.prototype.when\n\t\t\t= Handler.prototype.become\n\t\t\t= Handler.prototype.notify // deprecated\n\t\t\t= Handler.prototype.fail\n\t\t\t= Handler.prototype._unreport\n\t\t\t= Handler.prototype._report\n\t\t\t= noop;\n\n\t\tHandler.prototype._state = 0;\n\n\t\tHandler.prototype.state = function() {\n\t\t\treturn this._state;\n\t\t};\n\n\t\t/**\n\t\t * Recursively collapse handler chain to find the handler\n\t\t * nearest to the fully resolved value.\n\t\t * @returns {object} handler nearest the fully resolved value\n\t\t */\n\t\tHandler.prototype.join = function() {\n\t\t\tvar h = this;\n\t\t\twhile(h.handler !== void 0) {\n\t\t\t\th = h.handler;\n\t\t\t}\n\t\t\treturn h;\n\t\t};\n\n\t\tHandler.prototype.chain = function(to, receiver, fulfilled, rejected, progress) {\n\t\t\tthis.when({\n\t\t\t\tresolver: to,\n\t\t\t\treceiver: receiver,\n\t\t\t\tfulfilled: fulfilled,\n\t\t\t\trejected: rejected,\n\t\t\t\tprogress: progress\n\t\t\t});\n\t\t};\n\n\t\tHandler.prototype.visit = function(receiver, fulfilled, rejected, progress) {\n\t\t\tthis.chain(failIfRejected, receiver, fulfilled, rejected, progress);\n\t\t};\n\n\t\tHandler.prototype.fold = function(f, z, c, to) {\n\t\t\tthis.when(new Fold(f, z, c, to));\n\t\t};\n\n\t\t/**\n\t\t * Handler that invokes fail() on any handler it becomes\n\t\t * @constructor\n\t\t */\n\t\tfunction FailIfRejected() {}\n\n\t\tinherit(Handler, FailIfRejected);\n\n\t\tFailIfRejected.prototype.become = function(h) {\n\t\t\th.fail();\n\t\t};\n\n\t\tvar failIfRejected = new FailIfRejected();\n\n\t\t/**\n\t\t * Handler that manages a queue of consumers waiting on a pending promise\n\t\t * @constructor\n\t\t */\n\t\tfunction Pending(receiver, inheritedContext) {\n\t\t\tPromise.createContext(this, inheritedContext);\n\n\t\t\tthis.consumers = void 0;\n\t\t\tthis.receiver = receiver;\n\t\t\tthis.handler = void 0;\n\t\t\tthis.resolved = false;\n\t\t}\n\n\t\tinherit(Handler, Pending);\n\n\t\tPending.prototype._state = 0;\n\n\t\tPending.prototype.resolve = function(x) {\n\t\t\tthis.become(getHandler(x));\n\t\t};\n\n\t\tPending.prototype.reject = function(x) {\n\t\t\tif(this.resolved) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.become(new Rejected(x));\n\t\t};\n\n\t\tPending.prototype.join = function() {\n\t\t\tif (!this.resolved) {\n\t\t\t\treturn this;\n\t\t\t}\n\n\t\t\tvar h = this;\n\n\t\t\twhile (h.handler !== void 0) {\n\t\t\t\th = h.handler;\n\t\t\t\tif (h === this) {\n\t\t\t\t\treturn this.handler = cycle();\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn h;\n\t\t};\n\n\t\tPending.prototype.run = function() {\n\t\t\tvar q = this.consumers;\n\t\t\tvar handler = this.handler;\n\t\t\tthis.handler = this.handler.join();\n\t\t\tthis.consumers = void 0;\n\n\t\t\tfor (var i = 0; i < q.length; ++i) {\n\t\t\t\thandler.when(q[i]);\n\t\t\t}\n\t\t};\n\n\t\tPending.prototype.become = function(handler) {\n\t\t\tif(this.resolved) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.resolved = true;\n\t\t\tthis.handler = handler;\n\t\t\tif(this.consumers !== void 0) {\n\t\t\t\ttasks.enqueue(this);\n\t\t\t}\n\n\t\t\tif(this.context !== void 0) {\n\t\t\t\thandler._report(this.context);\n\t\t\t}\n\t\t};\n\n\t\tPending.prototype.when = function(continuation) {\n\t\t\tif(this.resolved) {\n\t\t\t\ttasks.enqueue(new ContinuationTask(continuation, this.handler));\n\t\t\t} else {\n\t\t\t\tif(this.consumers === void 0) {\n\t\t\t\t\tthis.consumers = [continuation];\n\t\t\t\t} else {\n\t\t\t\t\tthis.consumers.push(continuation);\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\n\t\t/**\n\t\t * @deprecated\n\t\t */\n\t\tPending.prototype.notify = function(x) {\n\t\t\tif(!this.resolved) {\n\t\t\t\ttasks.enqueue(new ProgressTask(x, this));\n\t\t\t}\n\t\t};\n\n\t\tPending.prototype.fail = function(context) {\n\t\t\tvar c = typeof context === 'undefined' ? this.context : context;\n\t\t\tthis.resolved && this.handler.join().fail(c);\n\t\t};\n\n\t\tPending.prototype._report = function(context) {\n\t\t\tthis.resolved && this.handler.join()._report(context);\n\t\t};\n\n\t\tPending.prototype._unreport = function() {\n\t\t\tthis.resolved && this.handler.join()._unreport();\n\t\t};\n\n\t\t/**\n\t\t * Wrap another handler and force it into a future stack\n\t\t * @param {object} handler\n\t\t * @constructor\n\t\t */\n\t\tfunction Async(handler) {\n\t\t\tthis.handler = handler;\n\t\t}\n\n\t\tinherit(Handler, Async);\n\n\t\tAsync.prototype.when = function(continuation) {\n\t\t\ttasks.enqueue(new ContinuationTask(continuation, this));\n\t\t};\n\n\t\tAsync.prototype._report = function(context) {\n\t\t\tthis.join()._report(context);\n\t\t};\n\n\t\tAsync.prototype._unreport = function() {\n\t\t\tthis.join()._unreport();\n\t\t};\n\n\t\t/**\n\t\t * Handler that wraps an untrusted thenable and assimilates it in a future stack\n\t\t * @param {function} then\n\t\t * @param {{then: function}} thenable\n\t\t * @constructor\n\t\t */\n\t\tfunction Thenable(then, thenable) {\n\t\t\tPending.call(this);\n\t\t\ttasks.enqueue(new AssimilateTask(then, thenable, this));\n\t\t}\n\n\t\tinherit(Pending, Thenable);\n\n\t\t/**\n\t\t * Handler for a fulfilled promise\n\t\t * @param {*} x fulfillment value\n\t\t * @constructor\n\t\t */\n\t\tfunction Fulfilled(x) {\n\t\t\tPromise.createContext(this);\n\t\t\tthis.value = x;\n\t\t}\n\n\t\tinherit(Handler, Fulfilled);\n\n\t\tFulfilled.prototype._state = 1;\n\n\t\tFulfilled.prototype.fold = function(f, z, c, to) {\n\t\t\trunContinuation3(f, z, this, c, to);\n\t\t};\n\n\t\tFulfilled.prototype.when = function(cont) {\n\t\t\trunContinuation1(cont.fulfilled, this, cont.receiver, cont.resolver);\n\t\t};\n\n\t\tvar errorId = 0;\n\n\t\t/**\n\t\t * Handler for a rejected promise\n\t\t * @param {*} x rejection reason\n\t\t * @constructor\n\t\t */\n\t\tfunction Rejected(x) {\n\t\t\tPromise.createContext(this);\n\n\t\t\tthis.id = ++errorId;\n\t\t\tthis.value = x;\n\t\t\tthis.handled = false;\n\t\t\tthis.reported = false;\n\n\t\t\tthis._report();\n\t\t}\n\n\t\tinherit(Handler, Rejected);\n\n\t\tRejected.prototype._state = -1;\n\n\t\tRejected.prototype.fold = function(f, z, c, to) {\n\t\t\tto.become(this);\n\t\t};\n\n\t\tRejected.prototype.when = function(cont) {\n\t\t\tif(typeof cont.rejected === 'function') {\n\t\t\t\tthis._unreport();\n\t\t\t}\n\t\t\trunContinuation1(cont.rejected, this, cont.receiver, cont.resolver);\n\t\t};\n\n\t\tRejected.prototype._report = function(context) {\n\t\t\ttasks.afterQueue(new ReportTask(this, context));\n\t\t};\n\n\t\tRejected.prototype._unreport = function() {\n\t\t\tif(this.handled) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tthis.handled = true;\n\t\t\ttasks.afterQueue(new UnreportTask(this));\n\t\t};\n\n\t\tRejected.prototype.fail = function(context) {\n\t\t\tthis.reported = true;\n\t\t\temitRejection('unhandledRejection', this);\n\t\t\tPromise.onFatalRejection(this, context === void 0 ? this.context : context);\n\t\t};\n\n\t\tfunction ReportTask(rejection, context) {\n\t\t\tthis.rejection = rejection;\n\t\t\tthis.context = context;\n\t\t}\n\n\t\tReportTask.prototype.run = function() {\n\t\t\tif(!this.rejection.handled && !this.rejection.reported) {\n\t\t\t\tthis.rejection.reported = true;\n\t\t\t\temitRejection('unhandledRejection', this.rejection) ||\n\t\t\t\t\tPromise.onPotentiallyUnhandledRejection(this.rejection, this.context);\n\t\t\t}\n\t\t};\n\n\t\tfunction UnreportTask(rejection) {\n\t\t\tthis.rejection = rejection;\n\t\t}\n\n\t\tUnreportTask.prototype.run = function() {\n\t\t\tif(this.rejection.reported) {\n\t\t\t\temitRejection('rejectionHandled', this.rejection) ||\n\t\t\t\t\tPromise.onPotentiallyUnhandledRejectionHandled(this.rejection);\n\t\t\t}\n\t\t};\n\n\t\t// Unhandled rejection hooks\n\t\t// By default, everything is a noop\n\n\t\tPromise.createContext\n\t\t\t= Promise.enterContext\n\t\t\t= Promise.exitContext\n\t\t\t= Promise.onPotentiallyUnhandledRejection\n\t\t\t= Promise.onPotentiallyUnhandledRejectionHandled\n\t\t\t= Promise.onFatalRejection\n\t\t\t= noop;\n\n\t\t// Errors and singletons\n\n\t\tvar foreverPendingHandler = new Handler();\n\t\tvar foreverPendingPromise = new Promise(Handler, foreverPendingHandler);\n\n\t\tfunction cycle() {\n\t\t\treturn new Rejected(new TypeError('Promise cycle'));\n\t\t}\n\n\t\t// Task runners\n\n\t\t/**\n\t\t * Run a single consumer\n\t\t * @constructor\n\t\t */\n\t\tfunction ContinuationTask(continuation, handler) {\n\t\t\tthis.continuation = continuation;\n\t\t\tthis.handler = handler;\n\t\t}\n\n\t\tContinuationTask.prototype.run = function() {\n\t\t\tthis.handler.join().when(this.continuation);\n\t\t};\n\n\t\t/**\n\t\t * Run a queue of progress handlers\n\t\t * @constructor\n\t\t */\n\t\tfunction ProgressTask(value, handler) {\n\t\t\tthis.handler = handler;\n\t\t\tthis.value = value;\n\t\t}\n\n\t\tProgressTask.prototype.run = function() {\n\t\t\tvar q = this.handler.consumers;\n\t\t\tif(q === void 0) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tfor (var c, i = 0; i < q.length; ++i) {\n\t\t\t\tc = q[i];\n\t\t\t\trunNotify(c.progress, this.value, this.handler, c.receiver, c.resolver);\n\t\t\t}\n\t\t};\n\n\t\t/**\n\t\t * Assimilate a thenable, sending it's value to resolver\n\t\t * @param {function} then\n\t\t * @param {object|function} thenable\n\t\t * @param {object} resolver\n\t\t * @constructor\n\t\t */\n\t\tfunction AssimilateTask(then, thenable, resolver) {\n\t\t\tthis._then = then;\n\t\t\tthis.thenable = thenable;\n\t\t\tthis.resolver = resolver;\n\t\t}\n\n\t\tAssimilateTask.prototype.run = function() {\n\t\t\tvar h = this.resolver;\n\t\t\ttryAssimilate(this._then, this.thenable, _resolve, _reject, _notify);\n\n\t\t\tfunction _resolve(x) { h.resolve(x); }\n\t\t\tfunction _reject(x)  { h.reject(x); }\n\t\t\tfunction _notify(x)  { h.notify(x); }\n\t\t};\n\n\t\tfunction tryAssimilate(then, thenable, resolve, reject, notify) {\n\t\t\ttry {\n\t\t\t\tthen.call(thenable, resolve, reject, notify);\n\t\t\t} catch (e) {\n\t\t\t\treject(e);\n\t\t\t}\n\t\t}\n\n\t\t/**\n\t\t * Fold a handler value with z\n\t\t * @constructor\n\t\t */\n\t\tfunction Fold(f, z, c, to) {\n\t\t\tthis.f = f; this.z = z; this.c = c; this.to = to;\n\t\t\tthis.resolver = failIfRejected;\n\t\t\tthis.receiver = this;\n\t\t}\n\n\t\tFold.prototype.fulfilled = function(x) {\n\t\t\tthis.f.call(this.c, this.z, x, this.to);\n\t\t};\n\n\t\tFold.prototype.rejected = function(x) {\n\t\t\tthis.to.reject(x);\n\t\t};\n\n\t\tFold.prototype.progress = function(x) {\n\t\t\tthis.to.notify(x);\n\t\t};\n\n\t\t// Other helpers\n\n\t\t/**\n\t\t * @param {*} x\n\t\t * @returns {boolean} true iff x is a trusted Promise\n\t\t */\n\t\tfunction isPromise(x) {\n\t\t\treturn x instanceof Promise;\n\t\t}\n\n\t\t/**\n\t\t * Test just enough to rule out primitives, in order to take faster\n\t\t * paths in some code\n\t\t * @param {*} x\n\t\t * @returns {boolean} false iff x is guaranteed *not* to be a thenable\n\t\t */\n\t\tfunction maybeThenable(x) {\n\t\t\treturn (typeof x === 'object' || typeof x === 'function') && x !== null;\n\t\t}\n\n\t\tfunction runContinuation1(f, h, receiver, next) {\n\t\t\tif(typeof f !== 'function') {\n\t\t\t\treturn next.become(h);\n\t\t\t}\n\n\t\t\tPromise.enterContext(h);\n\t\t\ttryCatchReject(f, h.value, receiver, next);\n\t\t\tPromise.exitContext();\n\t\t}\n\n\t\tfunction runContinuation3(f, x, h, receiver, next) {\n\t\t\tif(typeof f !== 'function') {\n\t\t\t\treturn next.become(h);\n\t\t\t}\n\n\t\t\tPromise.enterContext(h);\n\t\t\ttryCatchReject3(f, x, h.value, receiver, next);\n\t\t\tPromise.exitContext();\n\t\t}\n\n\t\t/**\n\t\t * @deprecated\n\t\t */\n\t\tfunction runNotify(f, x, h, receiver, next) {\n\t\t\tif(typeof f !== 'function') {\n\t\t\t\treturn next.notify(x);\n\t\t\t}\n\n\t\t\tPromise.enterContext(h);\n\t\t\ttryCatchReturn(f, x, receiver, next);\n\t\t\tPromise.exitContext();\n\t\t}\n\n\t\tfunction tryCatch2(f, a, b) {\n\t\t\ttry {\n\t\t\t\treturn f(a, b);\n\t\t\t} catch(e) {\n\t\t\t\treturn reject(e);\n\t\t\t}\n\t\t}\n\n\t\t/**\n\t\t * Return f.call(thisArg, x), or if it throws return a rejected promise for\n\t\t * the thrown exception\n\t\t */\n\t\tfunction tryCatchReject(f, x, thisArg, next) {\n\t\t\ttry {\n\t\t\t\tnext.become(getHandler(f.call(thisArg, x)));\n\t\t\t} catch(e) {\n\t\t\t\tnext.become(new Rejected(e));\n\t\t\t}\n\t\t}\n\n\t\t/**\n\t\t * Same as above, but includes the extra argument parameter.\n\t\t */\n\t\tfunction tryCatchReject3(f, x, y, thisArg, next) {\n\t\t\ttry {\n\t\t\t\tf.call(thisArg, x, y, next);\n\t\t\t} catch(e) {\n\t\t\t\tnext.become(new Rejected(e));\n\t\t\t}\n\t\t}\n\n\t\t/**\n\t\t * @deprecated\n\t\t * Return f.call(thisArg, x), or if it throws, *return* the exception\n\t\t */\n\t\tfunction tryCatchReturn(f, x, thisArg, next) {\n\t\t\ttry {\n\t\t\t\tnext.notify(f.call(thisArg, x));\n\t\t\t} catch(e) {\n\t\t\t\tnext.notify(e);\n\t\t\t}\n\t\t}\n\n\t\tfunction inherit(Parent, Child) {\n\t\t\tChild.prototype = objectCreate(Parent.prototype);\n\t\t\tChild.prototype.constructor = Child;\n\t\t}\n\n\t\tfunction snd(x, y) {\n\t\t\treturn y;\n\t\t}\n\n\t\tfunction noop() {}\n\n\t\tfunction initEmitRejection() {\n\t\t\t/*global process, self, CustomEvent*/\n\t\t\tif(typeof process !== 'undefined' && process !== null\n\t\t\t\t&& typeof process.emit === 'function') {\n\t\t\t\t// Returning falsy here means to call the default\n\t\t\t\t// onPotentiallyUnhandledRejection API.  This is safe even in\n\t\t\t\t// browserify since process.emit always returns falsy in browserify:\n\t\t\t\t// https://github.com/defunctzombie/node-process/blob/master/browser.js#L40-L46\n\t\t\t\treturn function(type, rejection) {\n\t\t\t\t\treturn type === 'unhandledRejection'\n\t\t\t\t\t\t? process.emit(type, rejection.value, rejection)\n\t\t\t\t\t\t: process.emit(type, rejection);\n\t\t\t\t};\n\t\t\t} else if(typeof self !== 'undefined' && typeof CustomEvent === 'function') {\n\t\t\t\treturn (function(noop, self, CustomEvent) {\n\t\t\t\t\tvar hasCustomEvent = false;\n\t\t\t\t\ttry {\n\t\t\t\t\t\tvar ev = new CustomEvent('unhandledRejection');\n\t\t\t\t\t\thasCustomEvent = ev instanceof CustomEvent;\n\t\t\t\t\t} catch (e) {}\n\n\t\t\t\t\treturn !hasCustomEvent ? noop : function(type, rejection) {\n\t\t\t\t\t\tvar ev = new CustomEvent(type, {\n\t\t\t\t\t\t\tdetail: {\n\t\t\t\t\t\t\t\treason: rejection.value,\n\t\t\t\t\t\t\t\tkey: rejection\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\tbubbles: false,\n\t\t\t\t\t\t\tcancelable: true\n\t\t\t\t\t\t});\n\n\t\t\t\t\t\treturn !self.dispatchEvent(ev);\n\t\t\t\t\t};\n\t\t\t\t}(noop, self, CustomEvent));\n\t\t\t}\n\n\t\t\treturn noop;\n\t\t}\n\n\t\treturn Promise;\n\t};\n});\n}(typeof define === 'function' && define.amd ? define : function(factory) { module.exports = factory(); }));\n\n},{}]},{},[1])\n//# sourceMappingURL=Promise.js.map\n(1)\n});\n;if (typeof systemJSBootstrap !== 'undefined')\n  systemJSBootstrap();})();\n"]}