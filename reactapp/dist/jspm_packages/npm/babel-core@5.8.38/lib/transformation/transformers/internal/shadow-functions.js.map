{"version":3,"sources":["../../../../../../../../jspm_packages/npm/babel-core@5.8.38/lib/transformation/transformers/internal/shadow-functions.js"],"names":["exports","__esModule","_interopRequireWildcard","obj","newObj","key","Object","prototype","hasOwnProperty","call","_types","require","t","metadata","group","shouldShadow","path","shadowPath","is","isArrowFunctionExpression","remap","create","inShadow","shadowFunction","node","_shadowedFunctionLiteral","currentFunction","fnPath","findParent","isProgram","isFunction","cached","getData","init","id","scope","generateUidIdentifier","setData","push","visitor","ThisExpression","thisExpression","ReferencedIdentifier","name","identifier"],"mappings":"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","file":"shadow-functions.js","sourcesContent":["/* */ \n\"format cjs\";\n\"use strict\";\n\nexports.__esModule = true;\n// istanbul ignore next\n\nfunction _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) newObj[key] = obj[key]; } } newObj[\"default\"] = obj; return newObj; } }\n\nvar _types = require(\"../../../types\");\n\nvar t = _interopRequireWildcard(_types);\n\nvar metadata = {\n  group: \"builtin-trailing\"\n};\n\nexports.metadata = metadata;\nfunction shouldShadow(path, shadowPath) {\n  if (path.is(\"_forceShadow\")) {\n    return true;\n  } else {\n    return shadowPath && !shadowPath.isArrowFunctionExpression();\n  }\n}\n\n/**\n * [Please add a description.]\n */\n\nfunction remap(path, key, create) {\n  // ensure that we're shadowed\n  var shadowPath = path.inShadow(key);\n  if (!shouldShadow(path, shadowPath)) return;\n\n  var shadowFunction = path.node._shadowedFunctionLiteral;\n  var currentFunction;\n\n  var fnPath = path.findParent(function (path) {\n    if (path.isProgram() || path.isFunction()) {\n      // catch current function in case this is the shadowed one and we can ignore it\n      currentFunction = currentFunction || path;\n    }\n\n    if (path.isProgram()) {\n      return true;\n    } else if (path.isFunction()) {\n      if (shadowFunction) {\n        return path === shadowFunction || path.node === shadowFunction.node;\n      } else {\n        return !path.is(\"shadow\");\n      }\n    }\n\n    return false;\n  });\n\n  // no point in realiasing if we're in this function\n  if (fnPath === currentFunction) return;\n\n  var cached = fnPath.getData(key);\n  if (cached) return cached;\n\n  var init = create();\n  var id = path.scope.generateUidIdentifier(key);\n\n  fnPath.setData(key, id);\n  fnPath.scope.push({ id: id, init: init });\n\n  return id;\n}\n\n/**\n * [Please add a description.]\n */\n\nvar visitor = {\n\n  /**\n   * [Please add a description.]\n   */\n\n  ThisExpression: function ThisExpression() {\n    return remap(this, \"this\", function () {\n      return t.thisExpression();\n    });\n  },\n\n  /**\n   * [Please add a description.]\n   */\n\n  ReferencedIdentifier: function ReferencedIdentifier(node) {\n    if (node.name === \"arguments\") {\n      return remap(this, \"arguments\", function () {\n        return t.identifier(\"arguments\");\n      });\n    }\n  }\n};\nexports.visitor = visitor;"]}