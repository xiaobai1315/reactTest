{"version":3,"sources":["../../../../../../../../../jspm_packages/npm/babel-core@5.8.38/lib/transformation/transformers/es6/parameters/default.js"],"names":["exports","__esModule","_interopRequireWildcard","obj","newObj","key","Object","prototype","hasOwnProperty","call","_interopRequireDefault","_helpersCallDelegate","require","_helpersCallDelegate2","_helpersGetFunctionArity","_helpersGetFunctionArity2","_util","util","_types","t","hasDefaults","node","i","params","length","isIdentifier","iifeVisitor","ReferencedIdentifier","parent","scope","state","name","hasOwnBinding","bindingIdentifierEquals","iife","stop","visitor","Function","file","ensureBlock","body","argsIdentifier","identifier","_shadowedFunctionLiteral","pushDefNode","left","right","defNode","exceedsLastNonDefault","isPattern","transformers","canTransform","template","VARIABLE_NAME","DEFAULT_VALUE","ARGUMENT_KEY","literal","ARGUMENTS","_blockHoist","push","lastNonDefaultParam","get","param","isAssignmentPattern","traverse","placeholder","generateUidIdentifier","_isDefaultPlaceholder","slice","blockStatement","concat"],"mappings":"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","file":"default.js","sourcesContent":["/* */ \n\"format cjs\";\n\"use strict\";\n\nexports.__esModule = true;\n// istanbul ignore next\n\nfunction _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) newObj[key] = obj[key]; } } newObj[\"default\"] = obj; return newObj; } }\n\n// istanbul ignore next\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { \"default\": obj }; }\n\nvar _helpersCallDelegate = require(\"../../../helpers/call-delegate\");\n\nvar _helpersCallDelegate2 = _interopRequireDefault(_helpersCallDelegate);\n\nvar _helpersGetFunctionArity = require(\"../../../helpers/get-function-arity\");\n\nvar _helpersGetFunctionArity2 = _interopRequireDefault(_helpersGetFunctionArity);\n\nvar _util = require(\"../../../../util\");\n\nvar util = _interopRequireWildcard(_util);\n\nvar _types = require(\"../../../../types\");\n\nvar t = _interopRequireWildcard(_types);\n\n/**\n * [Please add a description.]\n */\n\nvar hasDefaults = function hasDefaults(node) {\n  for (var i = 0; i < node.params.length; i++) {\n    if (!t.isIdentifier(node.params[i])) return true;\n  }\n  return false;\n};\n\n/**\n * [Please add a description.]\n */\n\nvar iifeVisitor = {\n\n  /**\n   * [Please add a description.]\n   */\n\n  ReferencedIdentifier: function ReferencedIdentifier(node, parent, scope, state) {\n    if (node.name !== \"eval\") {\n      if (!state.scope.hasOwnBinding(node.name)) return;\n      if (state.scope.bindingIdentifierEquals(node.name, node)) return;\n    }\n\n    state.iife = true;\n    this.stop();\n  }\n};\n\n/**\n * [Please add a description.]\n */\n\nvar visitor = {\n\n  /**\n   * [Please add a description.]\n   */\n\n  Function: function Function(node, parent, scope, file) {\n    if (!hasDefaults(node)) return;\n\n    // ensure it's a block, useful for arrow functions\n    this.ensureBlock();\n\n    var state = {\n      iife: false,\n      scope: scope\n    };\n\n    var body = [];\n\n    //\n    var argsIdentifier = t.identifier(\"arguments\");\n    argsIdentifier._shadowedFunctionLiteral = this;\n\n    // push a default parameter definition\n    function pushDefNode(left, right, i) {\n      var defNode;\n      if (exceedsLastNonDefault(i) || t.isPattern(left) || file.transformers[\"es6.spec.blockScoping\"].canTransform()) {\n        defNode = util.template(\"default-parameter\", {\n          VARIABLE_NAME: left,\n          DEFAULT_VALUE: right,\n          ARGUMENT_KEY: t.literal(i),\n          ARGUMENTS: argsIdentifier\n        }, true);\n      } else {\n        defNode = util.template(\"default-parameter-assign\", {\n          VARIABLE_NAME: left,\n          DEFAULT_VALUE: right\n        }, true);\n      }\n      defNode._blockHoist = node.params.length - i;\n      body.push(defNode);\n    }\n\n    // check if an index exceeds the functions arity\n    function exceedsLastNonDefault(i) {\n      return i + 1 > lastNonDefaultParam;\n    }\n\n    //\n    var lastNonDefaultParam = _helpersGetFunctionArity2[\"default\"](node);\n\n    //\n    var params = this.get(\"params\");\n    for (var i = 0; i < params.length; i++) {\n      var param = params[i];\n\n      if (!param.isAssignmentPattern()) {\n        if (!param.isIdentifier()) {\n          param.traverse(iifeVisitor, state);\n        }\n\n        if (file.transformers[\"es6.spec.blockScoping\"].canTransform() && param.isIdentifier()) {\n          pushDefNode(param.node, t.identifier(\"undefined\"), i);\n        }\n\n        continue;\n      }\n\n      var left = param.get(\"left\");\n      var right = param.get(\"right\");\n\n      if (exceedsLastNonDefault(i) || left.isPattern()) {\n        var placeholder = scope.generateUidIdentifier(\"x\");\n        placeholder._isDefaultPlaceholder = true;\n        node.params[i] = placeholder;\n      } else {\n        node.params[i] = left.node;\n      }\n\n      if (!state.iife) {\n        if (right.isIdentifier() && scope.hasOwnBinding(right.node.name)) {\n          state.iife = true;\n        } else {\n          right.traverse(iifeVisitor, state);\n        }\n      }\n\n      pushDefNode(left.node, right.node, i);\n    }\n\n    // we need to cut off all trailing default parameters\n    node.params = node.params.slice(0, lastNonDefaultParam);\n\n    if (state.iife) {\n      body.push(_helpersCallDelegate2[\"default\"](node, scope));\n      node.body = t.blockStatement(body);\n    } else {\n      node.body.body = body.concat(node.body.body);\n    }\n  }\n};\nexports.visitor = visitor;"]}