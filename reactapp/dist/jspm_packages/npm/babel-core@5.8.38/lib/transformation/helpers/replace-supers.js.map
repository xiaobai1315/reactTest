{"version":3,"sources":["../../../../../../../jspm_packages/npm/babel-core@5.8.38/lib/transformation/helpers/replace-supers.js"],"names":["exports","__esModule","_interopRequireWildcard","obj","newObj","key","Object","prototype","hasOwnProperty","call","_classCallCheck","instance","Constructor","TypeError","_messages","require","messages","_types","t","isIllegalBareSuper","node","parent","isSuper","isMemberExpression","computed","isCallExpression","callee","isMemberExpressionSuper","object","visitor","enter","scope","state","topLevel","self","isFunction","isArrowFunctionExpression","traverseLevel","skip","isProperty","method","isMethodDefinition","getThisReference","thisExpression","bind","callback","specHandle","isLoose","looseHandle","result","hasSuper","ReplaceSupers","opts","inClass","arguments","length","undefined","topLevelThisReference","methodPath","methodNode","superRef","isStatic","file","getObjectRef","objectRef","setSuperProperty","property","value","isComputed","callExpression","addHelper","memberExpression","identifier","literal","name","getSuperProperty","replace","get","path","traverse","ref","generateUidIdentifier","body","unshift","variableDeclaration","variableDeclarator","getLooseSuperProperty","id","methodName","isSpreadElement","isIdentifier","argument","appendToMemberExpression","specHandleAssignmentExpression","operator","left","right","expressionStatement","assignmentExpression","binaryExpression","args","thisReference","errorWithNode","isUpdateExpression","binary","prefix","concat","isAssignmentExpression","superProperty","module"],"mappings":"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","file":"replace-supers.js","sourcesContent":["/* */ \n\"format cjs\";\n\"use strict\";\n\nexports.__esModule = true;\n// istanbul ignore next\n\nfunction _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) newObj[key] = obj[key]; } } newObj[\"default\"] = obj; return newObj; } }\n\n// istanbul ignore next\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar _messages = require(\"../../messages\");\n\nvar messages = _interopRequireWildcard(_messages);\n\nvar _types = require(\"../../types\");\n\nvar t = _interopRequireWildcard(_types);\n\n/**\n * [Please add a description.]\n */\n\nfunction isIllegalBareSuper(node, parent) {\n  if (!t.isSuper(node)) return false;\n  if (t.isMemberExpression(parent, { computed: false })) return false;\n  if (t.isCallExpression(parent, { callee: node })) return false;\n  return true;\n}\n\n/**\n * [Please add a description.]\n */\n\nfunction isMemberExpressionSuper(node) {\n  return t.isMemberExpression(node) && t.isSuper(node.object);\n}\n\n/**\n * [Please add a description.]\n */\n\nvar visitor = {\n\n  /**\n   * [Please add a description.]\n   */\n\n  enter: function enter(node, parent, scope, state) {\n    var topLevel = state.topLevel;\n    var self = state.self;\n\n    if (t.isFunction(node) && !t.isArrowFunctionExpression(node)) {\n      // we need to call traverseLevel again so we're context aware\n      self.traverseLevel(this, false);\n      return this.skip();\n    }\n\n    if (t.isProperty(node, { method: true }) || t.isMethodDefinition(node)) {\n      // break on object methods\n      return this.skip();\n    }\n\n    var getThisReference = topLevel ?\n    // top level so `this` is the instance\n    t.thisExpression :\n    // not in the top level so we need to create a reference\n    self.getThisReference.bind(self);\n\n    var callback = self.specHandle;\n    if (self.isLoose) callback = self.looseHandle;\n    var result = callback.call(self, this, getThisReference);\n    if (result) this.hasSuper = true;\n    if (result === true) return;\n    return result;\n  }\n};\n\n/**\n * [Please add a description.]\n */\n\nvar ReplaceSupers = (function () {\n  function ReplaceSupers(opts) {\n    var inClass = arguments.length <= 1 || arguments[1] === undefined ? false : arguments[1];\n\n    _classCallCheck(this, ReplaceSupers);\n\n    this.topLevelThisReference = opts.topLevelThisReference;\n    this.methodPath = opts.methodPath;\n    this.methodNode = opts.methodNode;\n    this.superRef = opts.superRef;\n    this.isStatic = opts.isStatic;\n    this.hasSuper = false;\n    this.inClass = inClass;\n    this.isLoose = opts.isLoose;\n    this.scope = opts.scope;\n    this.file = opts.file;\n    this.opts = opts;\n  }\n\n  /**\n   * [Please add a description.]\n   */\n\n  ReplaceSupers.prototype.getObjectRef = function getObjectRef() {\n    return this.opts.objectRef || this.opts.getObjectRef();\n  };\n\n  /**\n   * Sets a super class value of the named property.\n   *\n   * @example\n   *\n   *   _set(Object.getPrototypeOf(CLASS.prototype), \"METHOD\", \"VALUE\", this)\n   *\n   */\n\n  ReplaceSupers.prototype.setSuperProperty = function setSuperProperty(property, value, isComputed, thisExpression) {\n    return t.callExpression(this.file.addHelper(\"set\"), [t.callExpression(t.memberExpression(t.identifier(\"Object\"), t.identifier(\"getPrototypeOf\")), [this.isStatic ? this.getObjectRef() : t.memberExpression(this.getObjectRef(), t.identifier(\"prototype\"))]), isComputed ? property : t.literal(property.name), value, thisExpression]);\n  };\n\n  /**\n   * Gets a node representing the super class value of the named property.\n   *\n   * @example\n   *\n   *   _get(Object.getPrototypeOf(CLASS.prototype), \"METHOD\", this)\n   *\n   */\n\n  ReplaceSupers.prototype.getSuperProperty = function getSuperProperty(property, isComputed, thisExpression) {\n    return t.callExpression(this.file.addHelper(\"get\"), [t.callExpression(t.memberExpression(t.identifier(\"Object\"), t.identifier(\"getPrototypeOf\")), [this.isStatic ? this.getObjectRef() : t.memberExpression(this.getObjectRef(), t.identifier(\"prototype\"))]), isComputed ? property : t.literal(property.name), thisExpression]);\n  };\n\n  /**\n   * [Please add a description.]\n   */\n\n  ReplaceSupers.prototype.replace = function replace() {\n    this.traverseLevel(this.methodPath.get(\"value\"), true);\n  };\n\n  /**\n   * [Please add a description.]\n   */\n\n  ReplaceSupers.prototype.traverseLevel = function traverseLevel(path, topLevel) {\n    var state = { self: this, topLevel: topLevel };\n    path.traverse(visitor, state);\n  };\n\n  /**\n   * [Please add a description.]\n   */\n\n  ReplaceSupers.prototype.getThisReference = function getThisReference() {\n    if (this.topLevelThisReference) {\n      return this.topLevelThisReference;\n    } else {\n      var ref = this.topLevelThisReference = this.scope.generateUidIdentifier(\"this\");\n      this.methodNode.value.body.body.unshift(t.variableDeclaration(\"var\", [t.variableDeclarator(this.topLevelThisReference, t.thisExpression())]));\n      return ref;\n    }\n  };\n\n  /**\n   * [Please add a description.]\n   */\n\n  ReplaceSupers.prototype.getLooseSuperProperty = function getLooseSuperProperty(id, parent) {\n    var methodNode = this.methodNode;\n    var methodName = methodNode.key;\n    var superRef = this.superRef || t.identifier(\"Function\");\n\n    if (parent.property === id) {\n      return;\n    } else if (t.isCallExpression(parent, { callee: id })) {\n      // super(); -> objectRef.prototype.MethodName.call(this);\n      parent.arguments.unshift(t.thisExpression());\n\n      if (methodName.name === \"constructor\") {\n        // constructor() { super(); }\n        if (parent.arguments.length === 2 && t.isSpreadElement(parent.arguments[1]) && t.isIdentifier(parent.arguments[1].argument, { name: \"arguments\" })) {\n          // special case single arguments spread\n          parent.arguments[1] = parent.arguments[1].argument;\n          return t.memberExpression(superRef, t.identifier(\"apply\"));\n        } else {\n          return t.memberExpression(superRef, t.identifier(\"call\"));\n        }\n      } else {\n        id = superRef;\n\n        // foo() { super(); }\n        if (!methodNode[\"static\"]) {\n          id = t.memberExpression(id, t.identifier(\"prototype\"));\n        }\n\n        id = t.memberExpression(id, methodName, methodNode.computed);\n        return t.memberExpression(id, t.identifier(\"call\"));\n      }\n    } else if (t.isMemberExpression(parent) && !methodNode[\"static\"]) {\n      // super.test -> objectRef.prototype.test\n      return t.memberExpression(superRef, t.identifier(\"prototype\"));\n    } else {\n      return superRef;\n    }\n  };\n\n  /**\n   * [Please add a description.]\n   */\n\n  ReplaceSupers.prototype.looseHandle = function looseHandle(path, getThisReference) {\n    var node = path.node;\n    if (path.isSuper()) {\n      return this.getLooseSuperProperty(node, path.parent);\n    } else if (path.isCallExpression()) {\n      var callee = node.callee;\n      if (!t.isMemberExpression(callee)) return;\n      if (!t.isSuper(callee.object)) return;\n\n      // super.test(); -> objectRef.prototype.MethodName.call(this);\n      t.appendToMemberExpression(callee, t.identifier(\"call\"));\n      node.arguments.unshift(getThisReference());\n      return true;\n    }\n  };\n\n  /**\n   * [Please add a description.]\n   */\n\n  ReplaceSupers.prototype.specHandleAssignmentExpression = function specHandleAssignmentExpression(ref, path, node, getThisReference) {\n    if (node.operator === \"=\") {\n      // super.name = \"val\"; -> _set(Object.getPrototypeOf(objectRef.prototype), \"name\", this);\n      return this.setSuperProperty(node.left.property, node.right, node.left.computed, getThisReference());\n    } else {\n      // super.age += 2; -> var _ref = super.age; super.age = _ref + 2;\n      ref = ref || path.scope.generateUidIdentifier(\"ref\");\n      return [t.variableDeclaration(\"var\", [t.variableDeclarator(ref, node.left)]), t.expressionStatement(t.assignmentExpression(\"=\", node.left, t.binaryExpression(node.operator[0], ref, node.right)))];\n    }\n  };\n\n  /**\n   * [Please add a description.]\n   */\n\n  ReplaceSupers.prototype.specHandle = function specHandle(path, getThisReference) {\n    var methodNode = this.methodNode;\n    var property;\n    var computed;\n    var args;\n    var thisReference;\n\n    var parent = path.parent;\n    var node = path.node;\n\n    if (isIllegalBareSuper(node, parent)) {\n      throw path.errorWithNode(messages.get(\"classesIllegalBareSuper\"));\n    }\n\n    if (t.isCallExpression(node)) {\n      var callee = node.callee;\n      if (t.isSuper(callee)) {\n        // super(); -> _get(Object.getPrototypeOf(objectRef), \"MethodName\", this).call(this);\n        property = methodNode.key;\n        computed = methodNode.computed;\n        args = node.arguments;\n\n        // bare `super` call is illegal inside non-constructors\n        //  - https://esdiscuss.org/topic/super-call-in-methods\n        //  - https://twitter.com/wycats/status/544553184396836864\n        if (methodNode.key.name !== \"constructor\" || !this.inClass) {\n          var methodName = methodNode.key.name || \"METHOD_NAME\";\n          throw this.file.errorWithNode(node, messages.get(\"classesIllegalSuperCall\", methodName));\n        }\n      } else if (isMemberExpressionSuper(callee)) {\n        // super.test(); -> _get(Object.getPrototypeOf(objectRef.prototype), \"test\", this).call(this);\n        property = callee.property;\n        computed = callee.computed;\n        args = node.arguments;\n      }\n    } else if (t.isMemberExpression(node) && t.isSuper(node.object)) {\n      // super.name; -> _get(Object.getPrototypeOf(objectRef.prototype), \"name\", this);\n      property = node.property;\n      computed = node.computed;\n    } else if (t.isUpdateExpression(node) && isMemberExpressionSuper(node.argument)) {\n      var binary = t.binaryExpression(node.operator[0], node.argument, t.literal(1));\n      if (node.prefix) {\n        // ++super.foo; -> super.foo += 1;\n        return this.specHandleAssignmentExpression(null, path, binary, getThisReference);\n      } else {\n        // super.foo++; -> var _ref = super.foo; super.foo = _ref + 1;\n        var ref = path.scope.generateUidIdentifier(\"ref\");\n        return this.specHandleAssignmentExpression(ref, path, binary, getThisReference).concat(t.expressionStatement(ref));\n      }\n    } else if (t.isAssignmentExpression(node) && isMemberExpressionSuper(node.left)) {\n      return this.specHandleAssignmentExpression(null, path, node, getThisReference);\n    }\n\n    if (!property) return;\n\n    thisReference = getThisReference();\n    var superProperty = this.getSuperProperty(property, computed, thisReference);\n    if (args) {\n      if (args.length === 1 && t.isSpreadElement(args[0])) {\n        // super(...arguments);\n        return t.callExpression(t.memberExpression(superProperty, t.identifier(\"apply\")), [thisReference, args[0].argument]);\n      } else {\n        return t.callExpression(t.memberExpression(superProperty, t.identifier(\"call\")), [thisReference].concat(args));\n      }\n    } else {\n      return superProperty;\n    }\n  };\n\n  return ReplaceSupers;\n})();\n\nexports[\"default\"] = ReplaceSupers;\nmodule.exports = exports[\"default\"];"]}