{"version":3,"sources":["../../../../../../../../jspm_packages/npm/babel-core@5.8.38/lib/transformation/modules/lib/remaps.js"],"names":["exports","__esModule","_interopRequireWildcard","obj","newObj","key","Object","prototype","hasOwnProperty","call","_classCallCheck","instance","Constructor","TypeError","_types","require","t","remapVisitor","enter","node","_skipModulesRemap","skip","ReferencedIdentifier","parent","scope","remaps","formatter","remap","get","name","hasBinding","bindingIdentifierEquals","localImports","isLoose","parentPath","isCallExpression","sequenceExpression","literal","AssignmentExpression","exit","_ref","_ignoreModulesRemap","exported","getExport","left","remapExportAssignment","UpdateExpression","_ref2","argument","assign","assignmentExpression","operator","remapped","isExpressionStatement","prefix","nodes","push","binaryExpression","Remaps","file","run","path","traverse","_getKey","getData","add","val","all","setData","remove","removeData","getAll","clearAll","_arr","_i","length","module"],"mappings":"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","file":"remaps.js","sourcesContent":["/* */ \n\"format cjs\";\n\"use strict\";\n\nexports.__esModule = true;\n// istanbul ignore next\n\nfunction _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) newObj[key] = obj[key]; } } newObj[\"default\"] = obj; return newObj; } }\n\n// istanbul ignore next\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar _types = require(\"../../../types\");\n\nvar t = _interopRequireWildcard(_types);\n\n/**\n * [Please add a description.]\n */\n\nvar remapVisitor = {\n\n  /**\n   * [Please add a description.]\n   */\n\n  enter: function enter(node) {\n    if (node._skipModulesRemap) {\n      return this.skip();\n    }\n  },\n\n  /**\n   * [Please add a description.]\n   */\n\n  ReferencedIdentifier: function ReferencedIdentifier(node, parent, scope, remaps) {\n    var formatter = remaps.formatter;\n\n    var remap = remaps.get(scope, node.name);\n    if (!remap || node === remap) return;\n\n    if (!scope.hasBinding(node.name) || scope.bindingIdentifierEquals(node.name, formatter.localImports[node.name])) {\n      if (!formatter.isLoose() && this.key === \"callee\" && this.parentPath.isCallExpression()) {\n        return t.sequenceExpression([t.literal(0), remap]);\n      } else {\n        return remap;\n      }\n    }\n  },\n\n  /**\n   * [Please add a description.]\n   */\n\n  AssignmentExpression: {\n    exit: function exit(node, parent, scope, _ref) {\n      var formatter = _ref.formatter;\n\n      if (!node._ignoreModulesRemap) {\n        var exported = formatter.getExport(node.left, scope);\n        if (exported) {\n          return formatter.remapExportAssignment(node, exported);\n        }\n      }\n    }\n  },\n\n  /**\n   * [Please add a description.]\n   */\n\n  UpdateExpression: function UpdateExpression(node, parent, scope, _ref2) {\n    var formatter = _ref2.formatter;\n\n    var exported = formatter.getExport(node.argument, scope);\n    if (!exported) return;\n\n    this.skip();\n\n    // expand to long file assignment expression\n    var assign = t.assignmentExpression(node.operator[0] + \"=\", node.argument, t.literal(1));\n\n    // remap this assignment expression\n    var remapped = formatter.remapExportAssignment(assign, exported);\n\n    // we don't need to change the result\n    if (t.isExpressionStatement(parent) || node.prefix) {\n      return remapped;\n    }\n\n    var nodes = [];\n    nodes.push(remapped);\n\n    var operator;\n    if (node.operator === \"--\") {\n      operator = \"+\";\n    } else {\n      // \"++\"\n      operator = \"-\";\n    }\n    nodes.push(t.binaryExpression(operator, node.argument, t.literal(1)));\n\n    return t.sequenceExpression(nodes);\n  }\n};\n\n/**\n * [Please add a description.]\n */\n\nvar Remaps = (function () {\n  function Remaps(file, formatter) {\n    _classCallCheck(this, Remaps);\n\n    this.formatter = formatter;\n    this.file = file;\n  }\n\n  /**\n   * [Please add a description.]\n   */\n\n  Remaps.prototype.run = function run() {\n    this.file.path.traverse(remapVisitor, this);\n  };\n\n  /**\n   * [Please add a description.]\n   */\n\n  Remaps.prototype._getKey = function _getKey(name) {\n    return name + \":moduleRemap\";\n  };\n\n  /**\n   * [Please add a description.]\n   */\n\n  Remaps.prototype.get = function get(scope, name) {\n    return scope.getData(this._getKey(name));\n  };\n\n  /**\n   * [Please add a description.]\n   */\n\n  Remaps.prototype.add = function add(scope, name, val) {\n    if (this.all) {\n      this.all.push({\n        name: name,\n        scope: scope,\n        node: val\n      });\n    }\n\n    return scope.setData(this._getKey(name), val);\n  };\n\n  /**\n   * [Please add a description.]\n   */\n\n  Remaps.prototype.remove = function remove(scope, name) {\n    return scope.removeData(this._getKey(name));\n  };\n\n  /**\n   * These methods are used by the system module formatter who needs access to all the remaps\n   * so it can process them into it's specific setter method. We don't do this by default since\n   * no other module formatters need access to this.\n   */\n\n  Remaps.prototype.getAll = function getAll() {\n    return this.all;\n  };\n\n  /**\n   * [Please add a description.]\n   */\n\n  Remaps.prototype.clearAll = function clearAll() {\n    if (this.all) {\n      var _arr = this.all;\n\n      for (var _i = 0; _i < _arr.length; _i++) {\n        var remap = _arr[_i];\n        remap.scope.removeData(this._getKey(remap.name));\n      }\n    }\n\n    this.all = [];\n  };\n\n  return Remaps;\n})();\n\nexports[\"default\"] = Remaps;\nmodule.exports = exports[\"default\"];"]}