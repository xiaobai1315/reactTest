{"version":3,"sources":["../../../../../../jspm_packages/npm/babel-core@5.8.38/lib/transformation/plugin.js"],"names":["exports","__esModule","_interopRequireWildcard","obj","newObj","key","Object","prototype","hasOwnProperty","call","_interopRequireDefault","_classCallCheck","instance","Constructor","TypeError","_pluginPass","require","_pluginPass2","_messages","messages","_traversal","_traversal2","_lodashObjectAssign","_lodashObjectAssign2","_lodashLangClone","_lodashLangClone2","_file","_file2","_types","t","VALID_PLUGIN_PROPERTIES","VALID_METADATA_PROPERTIES","Plugin","plugin","validate","take","val","manipulateOptions","metadata","dependencies","post","pre","stage","optional","visitor","normalize","name","indexOf","msgType","TYPES","Error","get","explode","buildPass","file","module"],"mappings":"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","file":"plugin.js","sourcesContent":["/* */ \n\"format cjs\";\n\"use strict\";\n\nexports.__esModule = true;\n// istanbul ignore next\n\nfunction _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) newObj[key] = obj[key]; } } newObj[\"default\"] = obj; return newObj; } }\n\n// istanbul ignore next\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { \"default\": obj }; }\n\n// istanbul ignore next\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar _pluginPass = require(\"./plugin-pass\");\n\nvar _pluginPass2 = _interopRequireDefault(_pluginPass);\n\nvar _messages = require(\"../messages\");\n\nvar messages = _interopRequireWildcard(_messages);\n\nvar _traversal = require(\"../traversal\");\n\nvar _traversal2 = _interopRequireDefault(_traversal);\n\nvar _lodashObjectAssign = require(\"lodash/object/assign\");\n\nvar _lodashObjectAssign2 = _interopRequireDefault(_lodashObjectAssign);\n\nvar _lodashLangClone = require(\"lodash/lang/clone\");\n\nvar _lodashLangClone2 = _interopRequireDefault(_lodashLangClone);\n\nvar _file = require(\"./file\");\n\nvar _file2 = _interopRequireDefault(_file);\n\nvar _types = require(\"../types\");\n\nvar t = _interopRequireWildcard(_types);\n\nvar VALID_PLUGIN_PROPERTIES = [\"visitor\", \"metadata\", \"manipulateOptions\", \"post\", \"pre\"];\n\nvar VALID_METADATA_PROPERTIES = [\"dependencies\", \"optional\", \"stage\", \"group\", \"experimental\", \"secondPass\"];\n\n/**\n * [Please add a description.]\n */\n\nvar Plugin = (function () {\n  function Plugin(key, plugin) {\n    _classCallCheck(this, Plugin);\n\n    Plugin.validate(key, plugin);\n\n    plugin = _lodashObjectAssign2[\"default\"]({}, plugin);\n\n    var take = function take(key) {\n      var val = plugin[key];\n      delete plugin[key];\n      return val;\n    };\n\n    this.manipulateOptions = take(\"manipulateOptions\");\n    this.metadata = take(\"metadata\") || {};\n    this.dependencies = this.metadata.dependencies || [];\n    this.post = take(\"post\");\n    this.pre = take(\"pre\");\n\n    //\n\n    if (this.metadata.stage != null) {\n      this.metadata.optional = true;\n    }\n\n    //\n\n    this.visitor = this.normalize(_lodashLangClone2[\"default\"](take(\"visitor\")) || {});\n    this.key = key;\n  }\n\n  /**\n   * [Please add a description.]\n   */\n\n  Plugin.validate = function validate(name, plugin) {\n    for (var key in plugin) {\n      if (key[0] === \"_\") continue;\n      if (VALID_PLUGIN_PROPERTIES.indexOf(key) >= 0) continue;\n\n      var msgType = \"pluginInvalidProperty\";\n      if (t.TYPES.indexOf(key) >= 0) msgType = \"pluginInvalidPropertyVisitor\";\n      throw new Error(messages.get(msgType, name, key));\n    }\n\n    for (var key in plugin.metadata) {\n      if (VALID_METADATA_PROPERTIES.indexOf(key) >= 0) continue;\n\n      throw new Error(messages.get(\"pluginInvalidProperty\", name, \"metadata.\" + key));\n    }\n  };\n\n  /**\n   * [Please add a description.]\n   */\n\n  Plugin.prototype.normalize = function normalize(visitor) {\n    _traversal2[\"default\"].explode(visitor);\n    return visitor;\n  };\n\n  /**\n   * [Please add a description.]\n   */\n\n  Plugin.prototype.buildPass = function buildPass(file) {\n    // validate Transformer instance\n    if (!(file instanceof _file2[\"default\"])) {\n      throw new TypeError(messages.get(\"pluginNotFile\", this.key));\n    }\n\n    return new _pluginPass2[\"default\"](file, this);\n  };\n\n  return Plugin;\n})();\n\nexports[\"default\"] = Plugin;\nmodule.exports = exports[\"default\"];"]}