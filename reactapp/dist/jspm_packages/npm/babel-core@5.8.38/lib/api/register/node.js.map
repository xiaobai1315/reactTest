{"version":3,"sources":["../../../../../../../jspm_packages/npm/babel-core@5.8.38/lib/api/register/node.js"],"names":["exports","__esModule","_interopRequireWildcard","obj","newObj","key","Object","prototype","hasOwnProperty","call","_interopRequireDefault","_sourceMapSupport","require","_sourceMapSupport2","_cache","registerCache","_transformationFileOptionsOptionManager","_transformationFileOptionsOptionManager2","_lodashObjectExtend","_lodashObjectExtend2","_node","babel","_lodashCollectionEach","_lodashCollectionEach2","_util","util","_fs","_fs2","_path","_path2","install","handleUncaughtExceptions","retrieveSourceMap","source","map","maps","url","load","cache","get","transformOpts","ignore","only","oldHandlers","cwd","process","getRelativePath","filename","relative","mtime","statSync","compile","opts","arguments","length","undefined","result","optsManager","mergeOptions","init","cacheKey","JSON","stringify","version","env","BABEL_ENV","NODE_ENV","cached","transformFileSync","sourceMap","ast","code","shouldIgnore","split","sep","indexOf","istanbulMonkey","running_under_istanbul","_readFileSync","readFileSync","auxiliaryCommentBefore","apply","istanbulLoader","m","old","normalLoader","_compile","registerExtension","ext","extensions","loader","hookExtensions","_exts","canCompile","EXTENSIONS","arrayify","regexify","module"],"mappings":"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","file":"node.js","sourcesContent":["/* */ \n\"format cjs\";\n\"use strict\";\n\nexports.__esModule = true;\n// istanbul ignore next\n\nfunction _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) newObj[key] = obj[key]; } } newObj[\"default\"] = obj; return newObj; } }\n\n// istanbul ignore next\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { \"default\": obj }; }\n\nvar _sourceMapSupport = require(\"source-map-support\");\n\nvar _sourceMapSupport2 = _interopRequireDefault(_sourceMapSupport);\n\nvar _cache = require(\"./cache\");\n\nvar registerCache = _interopRequireWildcard(_cache);\n\nvar _transformationFileOptionsOptionManager = require(\"../../transformation/file/options/option-manager\");\n\nvar _transformationFileOptionsOptionManager2 = _interopRequireDefault(_transformationFileOptionsOptionManager);\n\nvar _lodashObjectExtend = require(\"lodash/object/extend\");\n\nvar _lodashObjectExtend2 = _interopRequireDefault(_lodashObjectExtend);\n\nvar _node = require(\"../node\");\n\nvar babel = _interopRequireWildcard(_node);\n\nvar _lodashCollectionEach = require(\"lodash/collection/each\");\n\nvar _lodashCollectionEach2 = _interopRequireDefault(_lodashCollectionEach);\n\nvar _util = require(\"../../util\");\n\nvar util = _interopRequireWildcard(_util);\n\nvar _fs = require(\"fs\");\n\nvar _fs2 = _interopRequireDefault(_fs);\n\nvar _path = require(\"path\");\n\nvar _path2 = _interopRequireDefault(_path);\n\n/**\n * Install sourcemaps into node.\n */\n\n_sourceMapSupport2[\"default\"].install({\n  handleUncaughtExceptions: false,\n  retrieveSourceMap: function retrieveSourceMap(source) {\n    var map = maps && maps[source];\n    if (map) {\n      return {\n        url: null,\n        map: map\n      };\n    } else {\n      return null;\n    }\n  }\n});\n\n/**\n * Load and setup cache.\n */\n\nregisterCache.load();\nvar cache = registerCache.get();\n\n/**\n * Store options.\n */\n\nvar transformOpts = {};\n\nvar ignore;\nvar only;\n\nvar oldHandlers = {};\nvar maps = {};\n\nvar cwd = process.cwd();\n\n/**\n * Get path from `filename` relative to the current working directory.\n */\n\nvar getRelativePath = function getRelativePath(filename) {\n  return _path2[\"default\"].relative(cwd, filename);\n};\n\n/**\n * Get last modified time for a `filename`.\n */\n\nvar mtime = function mtime(filename) {\n  return +_fs2[\"default\"].statSync(filename).mtime;\n};\n\n/**\n * Compile a `filename` with optional `opts`.\n */\n\nvar compile = function compile(filename) {\n  var opts = arguments.length <= 1 || arguments[1] === undefined ? {} : arguments[1];\n\n  var result;\n\n  opts.filename = filename;\n\n  var optsManager = new _transformationFileOptionsOptionManager2[\"default\"]();\n  optsManager.mergeOptions(transformOpts);\n  opts = optsManager.init(opts);\n\n  var cacheKey = JSON.stringify(opts) + \":\" + babel.version;\n\n  var env = process.env.BABEL_ENV || process.env.NODE_ENV;\n  if (env) cacheKey += \":\" + env;\n\n  if (cache) {\n    var cached = cache[cacheKey];\n    if (cached && cached.mtime === mtime(filename)) {\n      result = cached;\n    }\n  }\n\n  if (!result) {\n    result = babel.transformFileSync(filename, _lodashObjectExtend2[\"default\"](opts, {\n      sourceMap: \"both\",\n      ast: false\n    }));\n  }\n\n  if (cache) {\n    result.mtime = mtime(filename);\n    cache[cacheKey] = result;\n  }\n\n  maps[filename] = result.map;\n\n  return result.code;\n};\n\n/**\n * Test if a `filename` should be ignored by Babel.\n */\n\nvar shouldIgnore = function shouldIgnore(filename) {\n  if (!ignore && !only) {\n    return getRelativePath(filename).split(_path2[\"default\"].sep).indexOf(\"node_modules\") >= 0;\n  } else {\n    return util.shouldIgnore(filename, ignore || [], only);\n  }\n};\n\n/**\n * Monkey patch istanbul if it is running so that it works properly.\n */\n\nvar istanbulMonkey = {};\n\nif (process.env.running_under_istanbul) {\n  // we need to monkey patch fs.readFileSync so we can hook into\n  // what istanbul gets, it's extremely dirty but it's the only way\n  var _readFileSync = _fs2[\"default\"].readFileSync;\n\n  _fs2[\"default\"].readFileSync = function (filename) {\n    if (istanbulMonkey[filename]) {\n      delete istanbulMonkey[filename];\n      var code = compile(filename, {\n        auxiliaryCommentBefore: \"istanbul ignore next\"\n      });\n      istanbulMonkey[filename] = true;\n      return code;\n    } else {\n      return _readFileSync.apply(this, arguments);\n    }\n  };\n}\n\n/**\n * Replacement for the loader for istanbul.\n */\n\nvar istanbulLoader = function istanbulLoader(m, filename, old) {\n  istanbulMonkey[filename] = true;\n  old(m, filename);\n};\n\n/**\n * Default loader.\n */\n\nvar normalLoader = function normalLoader(m, filename) {\n  m._compile(compile(filename), filename);\n};\n\n/**\n * Register a loader for an extension.\n */\n\nvar registerExtension = function registerExtension(ext) {\n  var old = oldHandlers[ext] || oldHandlers[\".js\"] || require.extensions[\".js\"];\n\n  var loader = normalLoader;\n  if (process.env.running_under_istanbul) loader = istanbulLoader;\n\n  require.extensions[ext] = function (m, filename) {\n    if (shouldIgnore(filename)) {\n      old(m, filename);\n    } else {\n      loader(m, filename, old);\n    }\n  };\n};\n\n/**\n * Register loader for given extensions.\n */\n\nvar hookExtensions = function hookExtensions(_exts) {\n  _lodashCollectionEach2[\"default\"](oldHandlers, function (old, ext) {\n    if (old === undefined) {\n      delete require.extensions[ext];\n    } else {\n      require.extensions[ext] = old;\n    }\n  });\n\n  oldHandlers = {};\n\n  _lodashCollectionEach2[\"default\"](_exts, function (ext) {\n    oldHandlers[ext] = require.extensions[ext];\n    registerExtension(ext);\n  });\n};\n\n/**\n * Register loader for default extensions.\n */\n\nhookExtensions(util.canCompile.EXTENSIONS);\n\n/**\n * Update options at runtime.\n */\n\nexports[\"default\"] = function () {\n  var opts = arguments.length <= 0 || arguments[0] === undefined ? {} : arguments[0];\n\n  if (opts.only != null) only = util.arrayify(opts.only, util.regexify);\n  if (opts.ignore != null) ignore = util.arrayify(opts.ignore, util.regexify);\n\n  if (opts.extensions) hookExtensions(util.arrayify(opts.extensions));\n\n  if (opts.cache === false) cache = null;\n\n  delete opts.extensions;\n  delete opts.ignore;\n  delete opts.cache;\n  delete opts.only;\n\n  _lodashObjectExtend2[\"default\"](transformOpts, opts);\n};\n\nmodule.exports = exports[\"default\"];"]}