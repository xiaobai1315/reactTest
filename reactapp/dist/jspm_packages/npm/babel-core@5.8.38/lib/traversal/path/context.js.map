{"version":3,"sources":["../../../../../../../jspm_packages/npm/babel-core@5.8.38/lib/traversal/path/context.js"],"names":["exports","__esModule","call","isBlacklisted","visit","skip","skipKey","stop","setScope","setContext","resync","_resyncParent","_resyncKey","_resyncList","_resyncRemoved","shiftContext","unshiftContext","setup","setKey","queueNode","_interopRequireDefault","obj","_index","require","_index2","key","node","opts","_arr","type","_i","length","fns","_arr2","_i2","fn","_node","previousType","replacement","parent","scope","state","replaceWith","shouldStop","shouldSkip","removed","blacklist","indexOf","Array","isArray","i","skipKeys","noScope","target","context","parentPath","getScope","init","container","listKey","newContainer","_markRemoved","contexts","shift","unshift","inList","parentKey","path","_arr3","_i3","queue","push"],"mappings":"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","file":"context.js","sourcesContent":["/* */ \n\"format cjs\";\n\"use strict\";\n\nexports.__esModule = true;\nexports.call = call;\nexports.isBlacklisted = isBlacklisted;\nexports.visit = visit;\nexports.skip = skip;\nexports.skipKey = skipKey;\nexports.stop = stop;\nexports.setScope = setScope;\nexports.setContext = setContext;\nexports.resync = resync;\nexports._resyncParent = _resyncParent;\nexports._resyncKey = _resyncKey;\nexports._resyncList = _resyncList;\nexports._resyncRemoved = _resyncRemoved;\nexports.shiftContext = shiftContext;\nexports.unshiftContext = unshiftContext;\nexports.setup = setup;\nexports.setKey = setKey;\nexports.queueNode = queueNode;\n// istanbul ignore next\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { \"default\": obj }; }\n\nvar _index = require(\"../index\");\n\nvar _index2 = _interopRequireDefault(_index);\n\n/**\n * [Please add a description.]\n */\n\nfunction call(key) {\n  var node = this.node;\n  if (!node) return;\n\n  var opts = this.opts;\n\n  var _arr = [opts[key], opts[node.type] && opts[node.type][key]];\n  for (var _i = 0; _i < _arr.length; _i++) {\n    var fns = _arr[_i];\n    if (!fns) continue;\n\n    var _arr2 = fns;\n    for (var _i2 = 0; _i2 < _arr2.length; _i2++) {\n      var fn = _arr2[_i2];\n      if (!fn) continue;\n\n      var _node = this.node;\n      if (!_node) return;\n\n      var previousType = this.type;\n\n      // call the function with the params (node, parent, scope, state)\n      var replacement = fn.call(this, _node, this.parent, this.scope, this.state);\n\n      if (replacement) {\n        this.replaceWith(replacement, true);\n      }\n\n      if (this.shouldStop || this.shouldSkip || this.removed) return;\n\n      if (previousType !== this.type) {\n        this.queueNode(this);\n        return;\n      }\n    }\n  }\n}\n\n/**\n * [Please add a description.]\n */\n\nfunction isBlacklisted() {\n  var blacklist = this.opts.blacklist;\n  return blacklist && blacklist.indexOf(this.node.type) > -1;\n}\n\n/**\n * Visits a node and calls appropriate enter and exit callbacks\n * as required.\n */\n\nfunction visit() {\n  if (this.isBlacklisted()) return false;\n  if (this.opts.shouldSkip && this.opts.shouldSkip(this)) return false;\n\n  this.call(\"enter\");\n\n  if (this.shouldSkip) {\n    return this.shouldStop;\n  }\n\n  var node = this.node;\n  var opts = this.opts;\n\n  if (node) {\n    if (Array.isArray(node)) {\n      // traverse over these replacement nodes we purposely don't call exitNode\n      // as the original node has been destroyed\n      for (var i = 0; i < node.length; i++) {\n        _index2[\"default\"].node(node[i], opts, this.scope, this.state, this, this.skipKeys);\n      }\n    } else {\n      _index2[\"default\"].node(node, opts, this.scope, this.state, this, this.skipKeys);\n      this.call(\"exit\");\n    }\n  }\n\n  return this.shouldStop;\n}\n\n/**\n * Sets shouldSkip flag true so that this node will be skipped while visiting.\n */\n\nfunction skip() {\n  this.shouldSkip = true;\n}\n\n/**\n * Adds given key to the list of keys to be skipped.\n */\n\nfunction skipKey(key) {\n  this.skipKeys[key] = true;\n}\n\n/**\n * [Please add a description.]\n */\n\nfunction stop() {\n  this.shouldStop = true;\n  this.shouldSkip = true;\n}\n\n/**\n * [Please add a description.]\n */\n\nfunction setScope() {\n  if (this.opts && this.opts.noScope) return;\n\n  var target = this.context || this.parentPath;\n  this.scope = this.getScope(target && target.scope);\n  if (this.scope) this.scope.init();\n}\n\n/**\n * [Please add a description.]\n */\n\nfunction setContext(context) {\n  this.shouldSkip = false;\n  this.shouldStop = false;\n  this.removed = false;\n  this.skipKeys = {};\n\n  if (context) {\n    this.context = context;\n    this.state = context.state;\n    this.opts = context.opts;\n  }\n\n  this.setScope();\n\n  return this;\n}\n\n/**\n * Here we resync the node paths `key` and `container`. If they've changed according\n * to what we have stored internally then we attempt to resync by crawling and looking\n * for the new values.\n */\n\nfunction resync() {\n  if (this.removed) return;\n\n  this._resyncParent();\n  this._resyncList();\n  this._resyncKey();\n  //this._resyncRemoved();\n}\n\n/**\n * [Please add a description.]\n */\n\nfunction _resyncParent() {\n  if (this.parentPath) {\n    this.parent = this.parentPath.node;\n  }\n}\n\n/**\n * [Please add a description.]\n */\n\nfunction _resyncKey() {\n  if (!this.container) return;\n\n  if (this.node === this.container[this.key]) return;\n\n  // grrr, path key is out of sync. this is likely due to a modification to the AST\n  // not done through our path APIs\n\n  if (Array.isArray(this.container)) {\n    for (var i = 0; i < this.container.length; i++) {\n      if (this.container[i] === this.node) {\n        return this.setKey(i);\n      }\n    }\n  } else {\n    for (var key in this.container) {\n      if (this.container[key] === this.node) {\n        return this.setKey(key);\n      }\n    }\n  }\n\n  this.key = null;\n}\n\n/**\n * [Please add a description.]\n */\n\nfunction _resyncList() {\n  var listKey = this.listKey;\n  var parentPath = this.parentPath;\n  if (!listKey || !parentPath) return;\n\n  var newContainer = parentPath.node[listKey];\n  if (this.container === newContainer) return;\n\n  // container is out of sync. this is likely the result of it being reassigned\n\n  if (newContainer) {\n    this.container = newContainer;\n  } else {\n    this.container = null;\n  }\n}\n\n/**\n * [Please add a description.]\n */\n\nfunction _resyncRemoved() {\n  if (this.key == null || !this.container || this.container[this.key] !== this.node) {\n    this._markRemoved();\n  }\n}\n\n/**\n * [Please add a description.]\n */\n\nfunction shiftContext() {\n  this.contexts.shift();\n  this.setContext(this.contexts[0]);\n}\n\n/**\n * [Please add a description.]\n */\n\nfunction unshiftContext(context) {\n  this.contexts.unshift(context);\n  this.setContext(context);\n}\n\n/**\n * [Please add a description.]\n */\n\nfunction setup(parentPath, container, listKey, key) {\n  this.inList = !!listKey;\n  this.listKey = listKey;\n  this.parentKey = listKey || key;\n  this.container = container;\n\n  this.parentPath = parentPath || this.parentPath;\n  this.setKey(key);\n}\n\n/**\n * [Please add a description.]\n */\n\nfunction setKey(key) {\n  this.key = key;\n  this.node = this.container[this.key];\n  this.type = this.node && this.node.type;\n}\n\n/**\n * [Please add a description.]\n */\n\nfunction queueNode(path) {\n  var _arr3 = this.contexts;\n\n  for (var _i3 = 0; _i3 < _arr3.length; _i3++) {\n    var context = _arr3[_i3];\n    if (context.queue) {\n      context.queue.push(path);\n    }\n  }\n}"]}