{"version":3,"sources":["../../../../../../jspm_packages/npm/babel-core@5.8.38/lib/traversal/visitors.js"],"names":["exports","__esModule","explode","verify","merge","_interopRequireDefault","obj","_interopRequireWildcard","newObj","key","Object","prototype","hasOwnProperty","call","_pathLibVirtualTypes","require","virtualTypes","_messages","messages","_types","t","_lodashLangClone","_lodashLangClone2","visitor","_exploded","nodeType","shouldIgnoreKey","parts","split","length","fns","_arr","_i","part","ensureEntranceObjects","ensureCallbackArrays","_arr2","keys","_i2","wrapper","type","wrapCheck","types","_arr4","_i4","mergePair","aliases","FLIPPED_ALIAS_KEYS","_arr3","_i3","alias","existing","_verified","Error","get","TYPES","indexOf","visitors","visitorKey","rootVisitor","_arr5","_i5","nodeVisitor","enter","Array","isArray","exit","fn","checkPath","apply","arguments","dest","src","concat"],"mappings":"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","file":"visitors.js","sourcesContent":["/* */ \n\"format cjs\";\n\"use strict\";\n\nexports.__esModule = true;\nexports.explode = explode;\nexports.verify = verify;\nexports.merge = merge;\n// istanbul ignore next\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { \"default\": obj }; }\n\n// istanbul ignore next\n\nfunction _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) newObj[key] = obj[key]; } } newObj[\"default\"] = obj; return newObj; } }\n\nvar _pathLibVirtualTypes = require(\"./path/lib/virtual-types\");\n\nvar virtualTypes = _interopRequireWildcard(_pathLibVirtualTypes);\n\nvar _messages = require(\"../messages\");\n\nvar messages = _interopRequireWildcard(_messages);\n\nvar _types = require(\"../types\");\n\nvar t = _interopRequireWildcard(_types);\n\nvar _lodashLangClone = require(\"lodash/lang/clone\");\n\nvar _lodashLangClone2 = _interopRequireDefault(_lodashLangClone);\n\n/**\n * [Please add a description.]\n */\n\nfunction explode(visitor) {\n  if (visitor._exploded) return visitor;\n  visitor._exploded = true;\n\n  // normalise pipes\n  for (var nodeType in visitor) {\n    if (shouldIgnoreKey(nodeType)) continue;\n\n    var parts = nodeType.split(\"|\");\n    if (parts.length === 1) continue;\n\n    var fns = visitor[nodeType];\n    delete visitor[nodeType];\n\n    var _arr = parts;\n    for (var _i = 0; _i < _arr.length; _i++) {\n      var part = _arr[_i];\n      visitor[part] = fns;\n    }\n  }\n\n  // verify data structure\n  verify(visitor);\n\n  // make sure there's no __esModule type since this is because we're using loose mode\n  // and it sets __esModule to be enumerable on all modules :(\n  delete visitor.__esModule;\n\n  // ensure visitors are objects\n  ensureEntranceObjects(visitor);\n\n  // ensure enter/exit callbacks are arrays\n  ensureCallbackArrays(visitor);\n\n  // add type wrappers\n\n  var _arr2 = Object.keys(visitor);\n\n  for (var _i2 = 0; _i2 < _arr2.length; _i2++) {\n    var nodeType = _arr2[_i2];\n    if (shouldIgnoreKey(nodeType)) continue;\n\n    var wrapper = virtualTypes[nodeType];\n    if (!wrapper) continue;\n\n    // wrap all the functions\n    var fns = visitor[nodeType];\n    for (var type in fns) {\n      fns[type] = wrapCheck(wrapper, fns[type]);\n    }\n\n    // clear it from the visitor\n    delete visitor[nodeType];\n\n    if (wrapper.types) {\n      var _arr4 = wrapper.types;\n\n      for (var _i4 = 0; _i4 < _arr4.length; _i4++) {\n        var type = _arr4[_i4];\n        // merge the visitor if necessary or just put it back in\n        if (visitor[type]) {\n          mergePair(visitor[type], fns);\n        } else {\n          visitor[type] = fns;\n        }\n      }\n    } else {\n      mergePair(visitor, fns);\n    }\n  }\n\n  // add aliases\n  for (var nodeType in visitor) {\n    if (shouldIgnoreKey(nodeType)) continue;\n\n    var fns = visitor[nodeType];\n\n    var aliases = t.FLIPPED_ALIAS_KEYS[nodeType];\n    if (!aliases) continue;\n\n    // clear it from the visitor\n    delete visitor[nodeType];\n\n    var _arr3 = aliases;\n    for (var _i3 = 0; _i3 < _arr3.length; _i3++) {\n      var alias = _arr3[_i3];\n      var existing = visitor[alias];\n      if (existing) {\n        mergePair(existing, fns);\n      } else {\n        visitor[alias] = _lodashLangClone2[\"default\"](fns);\n      }\n    }\n  }\n\n  for (var nodeType in visitor) {\n    if (shouldIgnoreKey(nodeType)) continue;\n\n    ensureCallbackArrays(visitor[nodeType]);\n  }\n\n  return visitor;\n}\n\n/**\n * [Please add a description.]\n */\n\nfunction verify(visitor) {\n  if (visitor._verified) return;\n\n  if (typeof visitor === \"function\") {\n    throw new Error(messages.get(\"traverseVerifyRootFunction\"));\n  }\n\n  for (var nodeType in visitor) {\n    if (shouldIgnoreKey(nodeType)) continue;\n\n    if (t.TYPES.indexOf(nodeType) < 0) {\n      throw new Error(messages.get(\"traverseVerifyNodeType\", nodeType));\n    }\n\n    var visitors = visitor[nodeType];\n    if (typeof visitors === \"object\") {\n      for (var visitorKey in visitors) {\n        if (visitorKey === \"enter\" || visitorKey === \"exit\") continue;\n        throw new Error(messages.get(\"traverseVerifyVisitorProperty\", nodeType, visitorKey));\n      }\n    }\n  }\n\n  visitor._verified = true;\n}\n\n/**\n * [Please add a description.]\n */\n\nfunction merge(visitors) {\n  var rootVisitor = {};\n\n  var _arr5 = visitors;\n  for (var _i5 = 0; _i5 < _arr5.length; _i5++) {\n    var visitor = _arr5[_i5];\n    explode(visitor);\n\n    for (var type in visitor) {\n      var nodeVisitor = rootVisitor[type] = rootVisitor[type] || {};\n      mergePair(nodeVisitor, visitor[type]);\n    }\n  }\n\n  return rootVisitor;\n}\n\n/**\n * [Please add a description.]\n */\n\nfunction ensureEntranceObjects(obj) {\n  for (var key in obj) {\n    if (shouldIgnoreKey(key)) continue;\n\n    var fns = obj[key];\n    if (typeof fns === \"function\") {\n      obj[key] = { enter: fns };\n    }\n  }\n}\n\n/**\n * Makes sure that enter and exit callbacks are arrays.\n */\n\nfunction ensureCallbackArrays(obj) {\n  if (obj.enter && !Array.isArray(obj.enter)) obj.enter = [obj.enter];\n  if (obj.exit && !Array.isArray(obj.exit)) obj.exit = [obj.exit];\n}\n\n/**\n * [Please add a description.]\n */\n\nfunction wrapCheck(wrapper, fn) {\n  return function () {\n    if (wrapper.checkPath(this)) {\n      return fn.apply(this, arguments);\n    }\n  };\n}\n\n/**\n * [Please add a description.]\n */\n\nfunction shouldIgnoreKey(key) {\n  // internal/hidden key\n  if (key[0] === \"_\") return true;\n\n  // ignore function keys\n  if (key === \"enter\" || key === \"exit\" || key === \"shouldSkip\") return true;\n\n  // ignore other options\n  if (key === \"blacklist\" || key === \"noScope\" || key === \"skipKeys\") return true;\n\n  return false;\n}\n\n/**\n * [Please add a description.]\n */\n\nfunction mergePair(dest, src) {\n  for (var key in src) {\n    dest[key] = [].concat(dest[key] || [], src[key]);\n  }\n}"]}