{"version":3,"sources":["../../../../../jspm_packages/npm/readable-stream@2.3.3/lib/_stream_readable.js"],"names":["Buffer","process","processNextTick","require","module","exports","Readable","isArray","Duplex","ReadableState","EE","EventEmitter","EElistenerCount","emitter","type","listeners","length","Stream","OurUint8Array","global","Uint8Array","_uint8ArrayToBuffer","chunk","from","_isUint8Array","obj","isBuffer","util","inherits","debugUtil","debug","debuglog","BufferList","destroyImpl","StringDecoder","kProxyEvents","prependListener","event","fn","_events","on","unshift","options","stream","objectMode","readableObjectMode","hwm","highWaterMark","defaultHwm","Math","floor","buffer","pipes","pipesCount","flowing","ended","endEmitted","reading","sync","needReadable","emittedReadable","readableListening","resumeScheduled","destroyed","defaultEncoding","awaitDrain","readingMore","decoder","encoding","_readableState","readable","read","_read","destroy","_destroy","call","Object","defineProperty","prototype","get","undefined","set","value","_undestroy","undestroy","err","cb","push","state","skipChunkCheck","readableAddChunk","addToFront","onEofChunk","er","chunkInvalid","emit","getPrototypeOf","Error","addChunk","write","maybeReadMore","needMoreData","emitReadable","TypeError","isPaused","setEncoding","enc","MAX_HWM","computeNewHighWaterMark","n","howMuchToRead","head","data","parseInt","nOrig","endReadable","doRead","ret","fromList","end","emitReadable_","flow","maybeReadMore_","len","pipe","dest","pipeOpts","src","doEnd","stdout","stderr","endFn","onend","unpipe","once","onunpipe","unpipeInfo","hasUnpiped","cleanup","ondrain","pipeOnDrain","cleanedUp","removeListener","onclose","onfinish","onerror","ondata","_writableState","needDrain","increasedAwaitDrain","indexOf","pause","resume","dests","i","index","splice","ev","res","nReadingNextTick","addListener","self","resume_","wrap","paused","method","apply","arguments","bind","_fromList","shift","join","concat","clear","fromListPartial","list","hasStrings","slice","copyFromBufferString","copyFromBuffer","p","c","next","str","nb","tail","allocUnsafe","copy","buf","endReadableNT","forEach","xs","f","l","x"],"mappings":"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","file":"_stream_readable.js","sourcesContent":["/* */ \n(function(Buffer, process) {\n  'use strict';\n  var processNextTick = require('process-nextick-args');\n  module.exports = Readable;\n  var isArray = require('isarray');\n  var Duplex;\n  Readable.ReadableState = ReadableState;\n  var EE = require('events').EventEmitter;\n  var EElistenerCount = function(emitter, type) {\n    return emitter.listeners(type).length;\n  };\n  var Stream = require('./internal/streams/stream-browser');\n  var Buffer = require('safe-buffer').Buffer;\n  var OurUint8Array = global.Uint8Array || function() {};\n  function _uint8ArrayToBuffer(chunk) {\n    return Buffer.from(chunk);\n  }\n  function _isUint8Array(obj) {\n    return Buffer.isBuffer(obj) || obj instanceof OurUint8Array;\n  }\n  var util = require('core-util-is');\n  util.inherits = require('inherits');\n  var debugUtil = require('@empty');\n  var debug = void 0;\n  if (debugUtil && debugUtil.debuglog) {\n    debug = debugUtil.debuglog('stream');\n  } else {\n    debug = function() {};\n  }\n  var BufferList = require('./internal/streams/BufferList');\n  var destroyImpl = require('./internal/streams/destroy');\n  var StringDecoder;\n  util.inherits(Readable, Stream);\n  var kProxyEvents = ['error', 'close', 'destroy', 'pause', 'resume'];\n  function prependListener(emitter, event, fn) {\n    if (typeof emitter.prependListener === 'function') {\n      return emitter.prependListener(event, fn);\n    } else {\n      if (!emitter._events || !emitter._events[event])\n        emitter.on(event, fn);\n      else if (isArray(emitter._events[event]))\n        emitter._events[event].unshift(fn);\n      else\n        emitter._events[event] = [fn, emitter._events[event]];\n    }\n  }\n  function ReadableState(options, stream) {\n    Duplex = Duplex || require('./_stream_duplex');\n    options = options || {};\n    this.objectMode = !!options.objectMode;\n    if (stream instanceof Duplex)\n      this.objectMode = this.objectMode || !!options.readableObjectMode;\n    var hwm = options.highWaterMark;\n    var defaultHwm = this.objectMode ? 16 : 16 * 1024;\n    this.highWaterMark = hwm || hwm === 0 ? hwm : defaultHwm;\n    this.highWaterMark = Math.floor(this.highWaterMark);\n    this.buffer = new BufferList();\n    this.length = 0;\n    this.pipes = null;\n    this.pipesCount = 0;\n    this.flowing = null;\n    this.ended = false;\n    this.endEmitted = false;\n    this.reading = false;\n    this.sync = true;\n    this.needReadable = false;\n    this.emittedReadable = false;\n    this.readableListening = false;\n    this.resumeScheduled = false;\n    this.destroyed = false;\n    this.defaultEncoding = options.defaultEncoding || 'utf8';\n    this.awaitDrain = 0;\n    this.readingMore = false;\n    this.decoder = null;\n    this.encoding = null;\n    if (options.encoding) {\n      if (!StringDecoder)\n        StringDecoder = require('string_decoder').StringDecoder;\n      this.decoder = new StringDecoder(options.encoding);\n      this.encoding = options.encoding;\n    }\n  }\n  function Readable(options) {\n    Duplex = Duplex || require('./_stream_duplex');\n    if (!(this instanceof Readable))\n      return new Readable(options);\n    this._readableState = new ReadableState(options, this);\n    this.readable = true;\n    if (options) {\n      if (typeof options.read === 'function')\n        this._read = options.read;\n      if (typeof options.destroy === 'function')\n        this._destroy = options.destroy;\n    }\n    Stream.call(this);\n  }\n  Object.defineProperty(Readable.prototype, 'destroyed', {\n    get: function() {\n      if (this._readableState === undefined) {\n        return false;\n      }\n      return this._readableState.destroyed;\n    },\n    set: function(value) {\n      if (!this._readableState) {\n        return;\n      }\n      this._readableState.destroyed = value;\n    }\n  });\n  Readable.prototype.destroy = destroyImpl.destroy;\n  Readable.prototype._undestroy = destroyImpl.undestroy;\n  Readable.prototype._destroy = function(err, cb) {\n    this.push(null);\n    cb(err);\n  };\n  Readable.prototype.push = function(chunk, encoding) {\n    var state = this._readableState;\n    var skipChunkCheck;\n    if (!state.objectMode) {\n      if (typeof chunk === 'string') {\n        encoding = encoding || state.defaultEncoding;\n        if (encoding !== state.encoding) {\n          chunk = Buffer.from(chunk, encoding);\n          encoding = '';\n        }\n        skipChunkCheck = true;\n      }\n    } else {\n      skipChunkCheck = true;\n    }\n    return readableAddChunk(this, chunk, encoding, false, skipChunkCheck);\n  };\n  Readable.prototype.unshift = function(chunk) {\n    return readableAddChunk(this, chunk, null, true, false);\n  };\n  function readableAddChunk(stream, chunk, encoding, addToFront, skipChunkCheck) {\n    var state = stream._readableState;\n    if (chunk === null) {\n      state.reading = false;\n      onEofChunk(stream, state);\n    } else {\n      var er;\n      if (!skipChunkCheck)\n        er = chunkInvalid(state, chunk);\n      if (er) {\n        stream.emit('error', er);\n      } else if (state.objectMode || chunk && chunk.length > 0) {\n        if (typeof chunk !== 'string' && !state.objectMode && Object.getPrototypeOf(chunk) !== Buffer.prototype) {\n          chunk = _uint8ArrayToBuffer(chunk);\n        }\n        if (addToFront) {\n          if (state.endEmitted)\n            stream.emit('error', new Error('stream.unshift() after end event'));\n          else\n            addChunk(stream, state, chunk, true);\n        } else if (state.ended) {\n          stream.emit('error', new Error('stream.push() after EOF'));\n        } else {\n          state.reading = false;\n          if (state.decoder && !encoding) {\n            chunk = state.decoder.write(chunk);\n            if (state.objectMode || chunk.length !== 0)\n              addChunk(stream, state, chunk, false);\n            else\n              maybeReadMore(stream, state);\n          } else {\n            addChunk(stream, state, chunk, false);\n          }\n        }\n      } else if (!addToFront) {\n        state.reading = false;\n      }\n    }\n    return needMoreData(state);\n  }\n  function addChunk(stream, state, chunk, addToFront) {\n    if (state.flowing && state.length === 0 && !state.sync) {\n      stream.emit('data', chunk);\n      stream.read(0);\n    } else {\n      state.length += state.objectMode ? 1 : chunk.length;\n      if (addToFront)\n        state.buffer.unshift(chunk);\n      else\n        state.buffer.push(chunk);\n      if (state.needReadable)\n        emitReadable(stream);\n    }\n    maybeReadMore(stream, state);\n  }\n  function chunkInvalid(state, chunk) {\n    var er;\n    if (!_isUint8Array(chunk) && typeof chunk !== 'string' && chunk !== undefined && !state.objectMode) {\n      er = new TypeError('Invalid non-string/buffer chunk');\n    }\n    return er;\n  }\n  function needMoreData(state) {\n    return !state.ended && (state.needReadable || state.length < state.highWaterMark || state.length === 0);\n  }\n  Readable.prototype.isPaused = function() {\n    return this._readableState.flowing === false;\n  };\n  Readable.prototype.setEncoding = function(enc) {\n    if (!StringDecoder)\n      StringDecoder = require('string_decoder').StringDecoder;\n    this._readableState.decoder = new StringDecoder(enc);\n    this._readableState.encoding = enc;\n    return this;\n  };\n  var MAX_HWM = 0x800000;\n  function computeNewHighWaterMark(n) {\n    if (n >= MAX_HWM) {\n      n = MAX_HWM;\n    } else {\n      n--;\n      n |= n >>> 1;\n      n |= n >>> 2;\n      n |= n >>> 4;\n      n |= n >>> 8;\n      n |= n >>> 16;\n      n++;\n    }\n    return n;\n  }\n  function howMuchToRead(n, state) {\n    if (n <= 0 || state.length === 0 && state.ended)\n      return 0;\n    if (state.objectMode)\n      return 1;\n    if (n !== n) {\n      if (state.flowing && state.length)\n        return state.buffer.head.data.length;\n      else\n        return state.length;\n    }\n    if (n > state.highWaterMark)\n      state.highWaterMark = computeNewHighWaterMark(n);\n    if (n <= state.length)\n      return n;\n    if (!state.ended) {\n      state.needReadable = true;\n      return 0;\n    }\n    return state.length;\n  }\n  Readable.prototype.read = function(n) {\n    debug('read', n);\n    n = parseInt(n, 10);\n    var state = this._readableState;\n    var nOrig = n;\n    if (n !== 0)\n      state.emittedReadable = false;\n    if (n === 0 && state.needReadable && (state.length >= state.highWaterMark || state.ended)) {\n      debug('read: emitReadable', state.length, state.ended);\n      if (state.length === 0 && state.ended)\n        endReadable(this);\n      else\n        emitReadable(this);\n      return null;\n    }\n    n = howMuchToRead(n, state);\n    if (n === 0 && state.ended) {\n      if (state.length === 0)\n        endReadable(this);\n      return null;\n    }\n    var doRead = state.needReadable;\n    debug('need readable', doRead);\n    if (state.length === 0 || state.length - n < state.highWaterMark) {\n      doRead = true;\n      debug('length less than watermark', doRead);\n    }\n    if (state.ended || state.reading) {\n      doRead = false;\n      debug('reading or ended', doRead);\n    } else if (doRead) {\n      debug('do read');\n      state.reading = true;\n      state.sync = true;\n      if (state.length === 0)\n        state.needReadable = true;\n      this._read(state.highWaterMark);\n      state.sync = false;\n      if (!state.reading)\n        n = howMuchToRead(nOrig, state);\n    }\n    var ret;\n    if (n > 0)\n      ret = fromList(n, state);\n    else\n      ret = null;\n    if (ret === null) {\n      state.needReadable = true;\n      n = 0;\n    } else {\n      state.length -= n;\n    }\n    if (state.length === 0) {\n      if (!state.ended)\n        state.needReadable = true;\n      if (nOrig !== n && state.ended)\n        endReadable(this);\n    }\n    if (ret !== null)\n      this.emit('data', ret);\n    return ret;\n  };\n  function onEofChunk(stream, state) {\n    if (state.ended)\n      return;\n    if (state.decoder) {\n      var chunk = state.decoder.end();\n      if (chunk && chunk.length) {\n        state.buffer.push(chunk);\n        state.length += state.objectMode ? 1 : chunk.length;\n      }\n    }\n    state.ended = true;\n    emitReadable(stream);\n  }\n  function emitReadable(stream) {\n    var state = stream._readableState;\n    state.needReadable = false;\n    if (!state.emittedReadable) {\n      debug('emitReadable', state.flowing);\n      state.emittedReadable = true;\n      if (state.sync)\n        processNextTick(emitReadable_, stream);\n      else\n        emitReadable_(stream);\n    }\n  }\n  function emitReadable_(stream) {\n    debug('emit readable');\n    stream.emit('readable');\n    flow(stream);\n  }\n  function maybeReadMore(stream, state) {\n    if (!state.readingMore) {\n      state.readingMore = true;\n      processNextTick(maybeReadMore_, stream, state);\n    }\n  }\n  function maybeReadMore_(stream, state) {\n    var len = state.length;\n    while (!state.reading && !state.flowing && !state.ended && state.length < state.highWaterMark) {\n      debug('maybeReadMore read 0');\n      stream.read(0);\n      if (len === state.length)\n        break;\n      else\n        len = state.length;\n    }\n    state.readingMore = false;\n  }\n  Readable.prototype._read = function(n) {\n    this.emit('error', new Error('_read() is not implemented'));\n  };\n  Readable.prototype.pipe = function(dest, pipeOpts) {\n    var src = this;\n    var state = this._readableState;\n    switch (state.pipesCount) {\n      case 0:\n        state.pipes = dest;\n        break;\n      case 1:\n        state.pipes = [state.pipes, dest];\n        break;\n      default:\n        state.pipes.push(dest);\n        break;\n    }\n    state.pipesCount += 1;\n    debug('pipe count=%d opts=%j', state.pipesCount, pipeOpts);\n    var doEnd = (!pipeOpts || pipeOpts.end !== false) && dest !== process.stdout && dest !== process.stderr;\n    var endFn = doEnd ? onend : unpipe;\n    if (state.endEmitted)\n      processNextTick(endFn);\n    else\n      src.once('end', endFn);\n    dest.on('unpipe', onunpipe);\n    function onunpipe(readable, unpipeInfo) {\n      debug('onunpipe');\n      if (readable === src) {\n        if (unpipeInfo && unpipeInfo.hasUnpiped === false) {\n          unpipeInfo.hasUnpiped = true;\n          cleanup();\n        }\n      }\n    }\n    function onend() {\n      debug('onend');\n      dest.end();\n    }\n    var ondrain = pipeOnDrain(src);\n    dest.on('drain', ondrain);\n    var cleanedUp = false;\n    function cleanup() {\n      debug('cleanup');\n      dest.removeListener('close', onclose);\n      dest.removeListener('finish', onfinish);\n      dest.removeListener('drain', ondrain);\n      dest.removeListener('error', onerror);\n      dest.removeListener('unpipe', onunpipe);\n      src.removeListener('end', onend);\n      src.removeListener('end', unpipe);\n      src.removeListener('data', ondata);\n      cleanedUp = true;\n      if (state.awaitDrain && (!dest._writableState || dest._writableState.needDrain))\n        ondrain();\n    }\n    var increasedAwaitDrain = false;\n    src.on('data', ondata);\n    function ondata(chunk) {\n      debug('ondata');\n      increasedAwaitDrain = false;\n      var ret = dest.write(chunk);\n      if (false === ret && !increasedAwaitDrain) {\n        if ((state.pipesCount === 1 && state.pipes === dest || state.pipesCount > 1 && indexOf(state.pipes, dest) !== -1) && !cleanedUp) {\n          debug('false write response, pause', src._readableState.awaitDrain);\n          src._readableState.awaitDrain++;\n          increasedAwaitDrain = true;\n        }\n        src.pause();\n      }\n    }\n    function onerror(er) {\n      debug('onerror', er);\n      unpipe();\n      dest.removeListener('error', onerror);\n      if (EElistenerCount(dest, 'error') === 0)\n        dest.emit('error', er);\n    }\n    prependListener(dest, 'error', onerror);\n    function onclose() {\n      dest.removeListener('finish', onfinish);\n      unpipe();\n    }\n    dest.once('close', onclose);\n    function onfinish() {\n      debug('onfinish');\n      dest.removeListener('close', onclose);\n      unpipe();\n    }\n    dest.once('finish', onfinish);\n    function unpipe() {\n      debug('unpipe');\n      src.unpipe(dest);\n    }\n    dest.emit('pipe', src);\n    if (!state.flowing) {\n      debug('pipe resume');\n      src.resume();\n    }\n    return dest;\n  };\n  function pipeOnDrain(src) {\n    return function() {\n      var state = src._readableState;\n      debug('pipeOnDrain', state.awaitDrain);\n      if (state.awaitDrain)\n        state.awaitDrain--;\n      if (state.awaitDrain === 0 && EElistenerCount(src, 'data')) {\n        state.flowing = true;\n        flow(src);\n      }\n    };\n  }\n  Readable.prototype.unpipe = function(dest) {\n    var state = this._readableState;\n    var unpipeInfo = {hasUnpiped: false};\n    if (state.pipesCount === 0)\n      return this;\n    if (state.pipesCount === 1) {\n      if (dest && dest !== state.pipes)\n        return this;\n      if (!dest)\n        dest = state.pipes;\n      state.pipes = null;\n      state.pipesCount = 0;\n      state.flowing = false;\n      if (dest)\n        dest.emit('unpipe', this, unpipeInfo);\n      return this;\n    }\n    if (!dest) {\n      var dests = state.pipes;\n      var len = state.pipesCount;\n      state.pipes = null;\n      state.pipesCount = 0;\n      state.flowing = false;\n      for (var i = 0; i < len; i++) {\n        dests[i].emit('unpipe', this, unpipeInfo);\n      }\n      return this;\n    }\n    var index = indexOf(state.pipes, dest);\n    if (index === -1)\n      return this;\n    state.pipes.splice(index, 1);\n    state.pipesCount -= 1;\n    if (state.pipesCount === 1)\n      state.pipes = state.pipes[0];\n    dest.emit('unpipe', this, unpipeInfo);\n    return this;\n  };\n  Readable.prototype.on = function(ev, fn) {\n    var res = Stream.prototype.on.call(this, ev, fn);\n    if (ev === 'data') {\n      if (this._readableState.flowing !== false)\n        this.resume();\n    } else if (ev === 'readable') {\n      var state = this._readableState;\n      if (!state.endEmitted && !state.readableListening) {\n        state.readableListening = state.needReadable = true;\n        state.emittedReadable = false;\n        if (!state.reading) {\n          processNextTick(nReadingNextTick, this);\n        } else if (state.length) {\n          emitReadable(this);\n        }\n      }\n    }\n    return res;\n  };\n  Readable.prototype.addListener = Readable.prototype.on;\n  function nReadingNextTick(self) {\n    debug('readable nexttick read 0');\n    self.read(0);\n  }\n  Readable.prototype.resume = function() {\n    var state = this._readableState;\n    if (!state.flowing) {\n      debug('resume');\n      state.flowing = true;\n      resume(this, state);\n    }\n    return this;\n  };\n  function resume(stream, state) {\n    if (!state.resumeScheduled) {\n      state.resumeScheduled = true;\n      processNextTick(resume_, stream, state);\n    }\n  }\n  function resume_(stream, state) {\n    if (!state.reading) {\n      debug('resume read 0');\n      stream.read(0);\n    }\n    state.resumeScheduled = false;\n    state.awaitDrain = 0;\n    stream.emit('resume');\n    flow(stream);\n    if (state.flowing && !state.reading)\n      stream.read(0);\n  }\n  Readable.prototype.pause = function() {\n    debug('call pause flowing=%j', this._readableState.flowing);\n    if (false !== this._readableState.flowing) {\n      debug('pause');\n      this._readableState.flowing = false;\n      this.emit('pause');\n    }\n    return this;\n  };\n  function flow(stream) {\n    var state = stream._readableState;\n    debug('flow', state.flowing);\n    while (state.flowing && stream.read() !== null) {}\n  }\n  Readable.prototype.wrap = function(stream) {\n    var state = this._readableState;\n    var paused = false;\n    var self = this;\n    stream.on('end', function() {\n      debug('wrapped end');\n      if (state.decoder && !state.ended) {\n        var chunk = state.decoder.end();\n        if (chunk && chunk.length)\n          self.push(chunk);\n      }\n      self.push(null);\n    });\n    stream.on('data', function(chunk) {\n      debug('wrapped data');\n      if (state.decoder)\n        chunk = state.decoder.write(chunk);\n      if (state.objectMode && (chunk === null || chunk === undefined))\n        return;\n      else if (!state.objectMode && (!chunk || !chunk.length))\n        return;\n      var ret = self.push(chunk);\n      if (!ret) {\n        paused = true;\n        stream.pause();\n      }\n    });\n    for (var i in stream) {\n      if (this[i] === undefined && typeof stream[i] === 'function') {\n        this[i] = function(method) {\n          return function() {\n            return stream[method].apply(stream, arguments);\n          };\n        }(i);\n      }\n    }\n    for (var n = 0; n < kProxyEvents.length; n++) {\n      stream.on(kProxyEvents[n], self.emit.bind(self, kProxyEvents[n]));\n    }\n    self._read = function(n) {\n      debug('wrapped _read', n);\n      if (paused) {\n        paused = false;\n        stream.resume();\n      }\n    };\n    return self;\n  };\n  Readable._fromList = fromList;\n  function fromList(n, state) {\n    if (state.length === 0)\n      return null;\n    var ret;\n    if (state.objectMode)\n      ret = state.buffer.shift();\n    else if (!n || n >= state.length) {\n      if (state.decoder)\n        ret = state.buffer.join('');\n      else if (state.buffer.length === 1)\n        ret = state.buffer.head.data;\n      else\n        ret = state.buffer.concat(state.length);\n      state.buffer.clear();\n    } else {\n      ret = fromListPartial(n, state.buffer, state.decoder);\n    }\n    return ret;\n  }\n  function fromListPartial(n, list, hasStrings) {\n    var ret;\n    if (n < list.head.data.length) {\n      ret = list.head.data.slice(0, n);\n      list.head.data = list.head.data.slice(n);\n    } else if (n === list.head.data.length) {\n      ret = list.shift();\n    } else {\n      ret = hasStrings ? copyFromBufferString(n, list) : copyFromBuffer(n, list);\n    }\n    return ret;\n  }\n  function copyFromBufferString(n, list) {\n    var p = list.head;\n    var c = 1;\n    var ret = p.data;\n    n -= ret.length;\n    while (p = p.next) {\n      var str = p.data;\n      var nb = n > str.length ? str.length : n;\n      if (nb === str.length)\n        ret += str;\n      else\n        ret += str.slice(0, n);\n      n -= nb;\n      if (n === 0) {\n        if (nb === str.length) {\n          ++c;\n          if (p.next)\n            list.head = p.next;\n          else\n            list.head = list.tail = null;\n        } else {\n          list.head = p;\n          p.data = str.slice(nb);\n        }\n        break;\n      }\n      ++c;\n    }\n    list.length -= c;\n    return ret;\n  }\n  function copyFromBuffer(n, list) {\n    var ret = Buffer.allocUnsafe(n);\n    var p = list.head;\n    var c = 1;\n    p.data.copy(ret);\n    n -= p.data.length;\n    while (p = p.next) {\n      var buf = p.data;\n      var nb = n > buf.length ? buf.length : n;\n      buf.copy(ret, ret.length - n, 0, nb);\n      n -= nb;\n      if (n === 0) {\n        if (nb === buf.length) {\n          ++c;\n          if (p.next)\n            list.head = p.next;\n          else\n            list.head = list.tail = null;\n        } else {\n          list.head = p;\n          p.data = buf.slice(nb);\n        }\n        break;\n      }\n      ++c;\n    }\n    list.length -= c;\n    return ret;\n  }\n  function endReadable(stream) {\n    var state = stream._readableState;\n    if (state.length > 0)\n      throw new Error('\"endReadable()\" called on non-empty stream');\n    if (!state.endEmitted) {\n      state.ended = true;\n      processNextTick(endReadableNT, state, stream);\n    }\n  }\n  function endReadableNT(state, stream) {\n    if (!state.endEmitted && state.length === 0) {\n      state.endEmitted = true;\n      stream.readable = false;\n      stream.emit('end');\n    }\n  }\n  function forEach(xs, f) {\n    for (var i = 0,\n        l = xs.length; i < l; i++) {\n      f(xs[i], i);\n    }\n  }\n  function indexOf(xs, x) {\n    for (var i = 0,\n        l = xs.length; i < l; i++) {\n      if (xs[i] === x)\n        return i;\n    }\n    return -1;\n  }\n})(require('buffer').Buffer, require('process'));\n"]}