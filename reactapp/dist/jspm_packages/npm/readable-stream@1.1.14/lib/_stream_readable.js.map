{"version":3,"sources":["../../../../../jspm_packages/npm/readable-stream@1.1.14/lib/_stream_readable.js"],"names":["Buffer","process","module","exports","Readable","isArray","require","ReadableState","EE","EventEmitter","listenerCount","emitter","type","listeners","length","Stream","util","inherits","StringDecoder","debug","debuglog","options","stream","Duplex","hwm","highWaterMark","defaultHwm","objectMode","buffer","pipes","pipesCount","flowing","ended","endEmitted","reading","sync","needReadable","emittedReadable","readableListening","readableObjectMode","defaultEncoding","ranOut","awaitDrain","readingMore","decoder","encoding","_readableState","readable","call","prototype","push","chunk","state","isString","readableAddChunk","unshift","addToFront","er","chunkInvalid","emit","isNullOrUndefined","onEofChunk","e","Error","write","read","emitReadable","maybeReadMore","needMoreData","setEncoding","enc","MAX_HWM","roundUpToNextPowerOf2","n","p","howMuchToRead","isNaN","isNull","nOrig","isNumber","endReadable","doRead","_read","ret","fromList","isBuffer","TypeError","end","nextTick","emitReadable_","flow","maybeReadMore_","len","pipe","dest","pipeOpts","src","doEnd","stdout","stderr","endFn","onend","cleanup","once","on","onunpipe","ondrain","pipeOnDrain","removeListener","onclose","onfinish","onerror","ondata","_writableState","needDrain","pause","unpipe","_events","error","resume","dests","i","indexOf","splice","ev","fn","res","self","addListener","resumeScheduled","resume_","wrap","paused","isFunction","isUndefined","method","apply","arguments","events","forEach","bind","_fromList","list","stringMode","shift","join","concat","buf","slice","c","l","cpy","Math","min","copy","xs","f","x"],"mappings":"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","file":"_stream_readable.js","sourcesContent":["/* */ \n(function(Buffer, process) {\n  module.exports = Readable;\n  var isArray = require('isarray');\n  var Buffer = require('buffer').Buffer;\n  Readable.ReadableState = ReadableState;\n  var EE = require('events').EventEmitter;\n  if (!EE.listenerCount)\n    EE.listenerCount = function(emitter, type) {\n      return emitter.listeners(type).length;\n    };\n  var Stream = require('stream-browserify/index');\n  var util = require('core-util-is');\n  util.inherits = require('inherits');\n  var StringDecoder;\n  var debug = require('@empty');\n  if (debug && debug.debuglog) {\n    debug = debug.debuglog('stream');\n  } else {\n    debug = function() {};\n  }\n  util.inherits(Readable, Stream);\n  function ReadableState(options, stream) {\n    var Duplex = require('./_stream_duplex');\n    options = options || {};\n    var hwm = options.highWaterMark;\n    var defaultHwm = options.objectMode ? 16 : 16 * 1024;\n    this.highWaterMark = (hwm || hwm === 0) ? hwm : defaultHwm;\n    this.highWaterMark = ~~this.highWaterMark;\n    this.buffer = [];\n    this.length = 0;\n    this.pipes = null;\n    this.pipesCount = 0;\n    this.flowing = null;\n    this.ended = false;\n    this.endEmitted = false;\n    this.reading = false;\n    this.sync = true;\n    this.needReadable = false;\n    this.emittedReadable = false;\n    this.readableListening = false;\n    this.objectMode = !!options.objectMode;\n    if (stream instanceof Duplex)\n      this.objectMode = this.objectMode || !!options.readableObjectMode;\n    this.defaultEncoding = options.defaultEncoding || 'utf8';\n    this.ranOut = false;\n    this.awaitDrain = 0;\n    this.readingMore = false;\n    this.decoder = null;\n    this.encoding = null;\n    if (options.encoding) {\n      if (!StringDecoder)\n        StringDecoder = require('string_decoder').StringDecoder;\n      this.decoder = new StringDecoder(options.encoding);\n      this.encoding = options.encoding;\n    }\n  }\n  function Readable(options) {\n    var Duplex = require('./_stream_duplex');\n    if (!(this instanceof Readable))\n      return new Readable(options);\n    this._readableState = new ReadableState(options, this);\n    this.readable = true;\n    Stream.call(this);\n  }\n  Readable.prototype.push = function(chunk, encoding) {\n    var state = this._readableState;\n    if (util.isString(chunk) && !state.objectMode) {\n      encoding = encoding || state.defaultEncoding;\n      if (encoding !== state.encoding) {\n        chunk = new Buffer(chunk, encoding);\n        encoding = '';\n      }\n    }\n    return readableAddChunk(this, state, chunk, encoding, false);\n  };\n  Readable.prototype.unshift = function(chunk) {\n    var state = this._readableState;\n    return readableAddChunk(this, state, chunk, '', true);\n  };\n  function readableAddChunk(stream, state, chunk, encoding, addToFront) {\n    var er = chunkInvalid(state, chunk);\n    if (er) {\n      stream.emit('error', er);\n    } else if (util.isNullOrUndefined(chunk)) {\n      state.reading = false;\n      if (!state.ended)\n        onEofChunk(stream, state);\n    } else if (state.objectMode || chunk && chunk.length > 0) {\n      if (state.ended && !addToFront) {\n        var e = new Error('stream.push() after EOF');\n        stream.emit('error', e);\n      } else if (state.endEmitted && addToFront) {\n        var e = new Error('stream.unshift() after end event');\n        stream.emit('error', e);\n      } else {\n        if (state.decoder && !addToFront && !encoding)\n          chunk = state.decoder.write(chunk);\n        if (!addToFront)\n          state.reading = false;\n        if (state.flowing && state.length === 0 && !state.sync) {\n          stream.emit('data', chunk);\n          stream.read(0);\n        } else {\n          state.length += state.objectMode ? 1 : chunk.length;\n          if (addToFront)\n            state.buffer.unshift(chunk);\n          else\n            state.buffer.push(chunk);\n          if (state.needReadable)\n            emitReadable(stream);\n        }\n        maybeReadMore(stream, state);\n      }\n    } else if (!addToFront) {\n      state.reading = false;\n    }\n    return needMoreData(state);\n  }\n  function needMoreData(state) {\n    return !state.ended && (state.needReadable || state.length < state.highWaterMark || state.length === 0);\n  }\n  Readable.prototype.setEncoding = function(enc) {\n    if (!StringDecoder)\n      StringDecoder = require('string_decoder').StringDecoder;\n    this._readableState.decoder = new StringDecoder(enc);\n    this._readableState.encoding = enc;\n    return this;\n  };\n  var MAX_HWM = 0x800000;\n  function roundUpToNextPowerOf2(n) {\n    if (n >= MAX_HWM) {\n      n = MAX_HWM;\n    } else {\n      n--;\n      for (var p = 1; p < 32; p <<= 1)\n        n |= n >> p;\n      n++;\n    }\n    return n;\n  }\n  function howMuchToRead(n, state) {\n    if (state.length === 0 && state.ended)\n      return 0;\n    if (state.objectMode)\n      return n === 0 ? 0 : 1;\n    if (isNaN(n) || util.isNull(n)) {\n      if (state.flowing && state.buffer.length)\n        return state.buffer[0].length;\n      else\n        return state.length;\n    }\n    if (n <= 0)\n      return 0;\n    if (n > state.highWaterMark)\n      state.highWaterMark = roundUpToNextPowerOf2(n);\n    if (n > state.length) {\n      if (!state.ended) {\n        state.needReadable = true;\n        return 0;\n      } else\n        return state.length;\n    }\n    return n;\n  }\n  Readable.prototype.read = function(n) {\n    debug('read', n);\n    var state = this._readableState;\n    var nOrig = n;\n    if (!util.isNumber(n) || n > 0)\n      state.emittedReadable = false;\n    if (n === 0 && state.needReadable && (state.length >= state.highWaterMark || state.ended)) {\n      debug('read: emitReadable', state.length, state.ended);\n      if (state.length === 0 && state.ended)\n        endReadable(this);\n      else\n        emitReadable(this);\n      return null;\n    }\n    n = howMuchToRead(n, state);\n    if (n === 0 && state.ended) {\n      if (state.length === 0)\n        endReadable(this);\n      return null;\n    }\n    var doRead = state.needReadable;\n    debug('need readable', doRead);\n    if (state.length === 0 || state.length - n < state.highWaterMark) {\n      doRead = true;\n      debug('length less than watermark', doRead);\n    }\n    if (state.ended || state.reading) {\n      doRead = false;\n      debug('reading or ended', doRead);\n    }\n    if (doRead) {\n      debug('do read');\n      state.reading = true;\n      state.sync = true;\n      if (state.length === 0)\n        state.needReadable = true;\n      this._read(state.highWaterMark);\n      state.sync = false;\n    }\n    if (doRead && !state.reading)\n      n = howMuchToRead(nOrig, state);\n    var ret;\n    if (n > 0)\n      ret = fromList(n, state);\n    else\n      ret = null;\n    if (util.isNull(ret)) {\n      state.needReadable = true;\n      n = 0;\n    }\n    state.length -= n;\n    if (state.length === 0 && !state.ended)\n      state.needReadable = true;\n    if (nOrig !== n && state.ended && state.length === 0)\n      endReadable(this);\n    if (!util.isNull(ret))\n      this.emit('data', ret);\n    return ret;\n  };\n  function chunkInvalid(state, chunk) {\n    var er = null;\n    if (!util.isBuffer(chunk) && !util.isString(chunk) && !util.isNullOrUndefined(chunk) && !state.objectMode) {\n      er = new TypeError('Invalid non-string/buffer chunk');\n    }\n    return er;\n  }\n  function onEofChunk(stream, state) {\n    if (state.decoder && !state.ended) {\n      var chunk = state.decoder.end();\n      if (chunk && chunk.length) {\n        state.buffer.push(chunk);\n        state.length += state.objectMode ? 1 : chunk.length;\n      }\n    }\n    state.ended = true;\n    emitReadable(stream);\n  }\n  function emitReadable(stream) {\n    var state = stream._readableState;\n    state.needReadable = false;\n    if (!state.emittedReadable) {\n      debug('emitReadable', state.flowing);\n      state.emittedReadable = true;\n      if (state.sync)\n        process.nextTick(function() {\n          emitReadable_(stream);\n        });\n      else\n        emitReadable_(stream);\n    }\n  }\n  function emitReadable_(stream) {\n    debug('emit readable');\n    stream.emit('readable');\n    flow(stream);\n  }\n  function maybeReadMore(stream, state) {\n    if (!state.readingMore) {\n      state.readingMore = true;\n      process.nextTick(function() {\n        maybeReadMore_(stream, state);\n      });\n    }\n  }\n  function maybeReadMore_(stream, state) {\n    var len = state.length;\n    while (!state.reading && !state.flowing && !state.ended && state.length < state.highWaterMark) {\n      debug('maybeReadMore read 0');\n      stream.read(0);\n      if (len === state.length)\n        break;\n      else\n        len = state.length;\n    }\n    state.readingMore = false;\n  }\n  Readable.prototype._read = function(n) {\n    this.emit('error', new Error('not implemented'));\n  };\n  Readable.prototype.pipe = function(dest, pipeOpts) {\n    var src = this;\n    var state = this._readableState;\n    switch (state.pipesCount) {\n      case 0:\n        state.pipes = dest;\n        break;\n      case 1:\n        state.pipes = [state.pipes, dest];\n        break;\n      default:\n        state.pipes.push(dest);\n        break;\n    }\n    state.pipesCount += 1;\n    debug('pipe count=%d opts=%j', state.pipesCount, pipeOpts);\n    var doEnd = (!pipeOpts || pipeOpts.end !== false) && dest !== process.stdout && dest !== process.stderr;\n    var endFn = doEnd ? onend : cleanup;\n    if (state.endEmitted)\n      process.nextTick(endFn);\n    else\n      src.once('end', endFn);\n    dest.on('unpipe', onunpipe);\n    function onunpipe(readable) {\n      debug('onunpipe');\n      if (readable === src) {\n        cleanup();\n      }\n    }\n    function onend() {\n      debug('onend');\n      dest.end();\n    }\n    var ondrain = pipeOnDrain(src);\n    dest.on('drain', ondrain);\n    function cleanup() {\n      debug('cleanup');\n      dest.removeListener('close', onclose);\n      dest.removeListener('finish', onfinish);\n      dest.removeListener('drain', ondrain);\n      dest.removeListener('error', onerror);\n      dest.removeListener('unpipe', onunpipe);\n      src.removeListener('end', onend);\n      src.removeListener('end', cleanup);\n      src.removeListener('data', ondata);\n      if (state.awaitDrain && (!dest._writableState || dest._writableState.needDrain))\n        ondrain();\n    }\n    src.on('data', ondata);\n    function ondata(chunk) {\n      debug('ondata');\n      var ret = dest.write(chunk);\n      if (false === ret) {\n        debug('false write response, pause', src._readableState.awaitDrain);\n        src._readableState.awaitDrain++;\n        src.pause();\n      }\n    }\n    function onerror(er) {\n      debug('onerror', er);\n      unpipe();\n      dest.removeListener('error', onerror);\n      if (EE.listenerCount(dest, 'error') === 0)\n        dest.emit('error', er);\n    }\n    if (!dest._events || !dest._events.error)\n      dest.on('error', onerror);\n    else if (isArray(dest._events.error))\n      dest._events.error.unshift(onerror);\n    else\n      dest._events.error = [onerror, dest._events.error];\n    function onclose() {\n      dest.removeListener('finish', onfinish);\n      unpipe();\n    }\n    dest.once('close', onclose);\n    function onfinish() {\n      debug('onfinish');\n      dest.removeListener('close', onclose);\n      unpipe();\n    }\n    dest.once('finish', onfinish);\n    function unpipe() {\n      debug('unpipe');\n      src.unpipe(dest);\n    }\n    dest.emit('pipe', src);\n    if (!state.flowing) {\n      debug('pipe resume');\n      src.resume();\n    }\n    return dest;\n  };\n  function pipeOnDrain(src) {\n    return function() {\n      var state = src._readableState;\n      debug('pipeOnDrain', state.awaitDrain);\n      if (state.awaitDrain)\n        state.awaitDrain--;\n      if (state.awaitDrain === 0 && EE.listenerCount(src, 'data')) {\n        state.flowing = true;\n        flow(src);\n      }\n    };\n  }\n  Readable.prototype.unpipe = function(dest) {\n    var state = this._readableState;\n    if (state.pipesCount === 0)\n      return this;\n    if (state.pipesCount === 1) {\n      if (dest && dest !== state.pipes)\n        return this;\n      if (!dest)\n        dest = state.pipes;\n      state.pipes = null;\n      state.pipesCount = 0;\n      state.flowing = false;\n      if (dest)\n        dest.emit('unpipe', this);\n      return this;\n    }\n    if (!dest) {\n      var dests = state.pipes;\n      var len = state.pipesCount;\n      state.pipes = null;\n      state.pipesCount = 0;\n      state.flowing = false;\n      for (var i = 0; i < len; i++)\n        dests[i].emit('unpipe', this);\n      return this;\n    }\n    var i = indexOf(state.pipes, dest);\n    if (i === -1)\n      return this;\n    state.pipes.splice(i, 1);\n    state.pipesCount -= 1;\n    if (state.pipesCount === 1)\n      state.pipes = state.pipes[0];\n    dest.emit('unpipe', this);\n    return this;\n  };\n  Readable.prototype.on = function(ev, fn) {\n    var res = Stream.prototype.on.call(this, ev, fn);\n    if (ev === 'data' && false !== this._readableState.flowing) {\n      this.resume();\n    }\n    if (ev === 'readable' && this.readable) {\n      var state = this._readableState;\n      if (!state.readableListening) {\n        state.readableListening = true;\n        state.emittedReadable = false;\n        state.needReadable = true;\n        if (!state.reading) {\n          var self = this;\n          process.nextTick(function() {\n            debug('readable nexttick read 0');\n            self.read(0);\n          });\n        } else if (state.length) {\n          emitReadable(this, state);\n        }\n      }\n    }\n    return res;\n  };\n  Readable.prototype.addListener = Readable.prototype.on;\n  Readable.prototype.resume = function() {\n    var state = this._readableState;\n    if (!state.flowing) {\n      debug('resume');\n      state.flowing = true;\n      if (!state.reading) {\n        debug('resume read 0');\n        this.read(0);\n      }\n      resume(this, state);\n    }\n    return this;\n  };\n  function resume(stream, state) {\n    if (!state.resumeScheduled) {\n      state.resumeScheduled = true;\n      process.nextTick(function() {\n        resume_(stream, state);\n      });\n    }\n  }\n  function resume_(stream, state) {\n    state.resumeScheduled = false;\n    stream.emit('resume');\n    flow(stream);\n    if (state.flowing && !state.reading)\n      stream.read(0);\n  }\n  Readable.prototype.pause = function() {\n    debug('call pause flowing=%j', this._readableState.flowing);\n    if (false !== this._readableState.flowing) {\n      debug('pause');\n      this._readableState.flowing = false;\n      this.emit('pause');\n    }\n    return this;\n  };\n  function flow(stream) {\n    var state = stream._readableState;\n    debug('flow', state.flowing);\n    if (state.flowing) {\n      do {\n        var chunk = stream.read();\n      } while (null !== chunk && state.flowing);\n    }\n  }\n  Readable.prototype.wrap = function(stream) {\n    var state = this._readableState;\n    var paused = false;\n    var self = this;\n    stream.on('end', function() {\n      debug('wrapped end');\n      if (state.decoder && !state.ended) {\n        var chunk = state.decoder.end();\n        if (chunk && chunk.length)\n          self.push(chunk);\n      }\n      self.push(null);\n    });\n    stream.on('data', function(chunk) {\n      debug('wrapped data');\n      if (state.decoder)\n        chunk = state.decoder.write(chunk);\n      if (!chunk || !state.objectMode && !chunk.length)\n        return;\n      var ret = self.push(chunk);\n      if (!ret) {\n        paused = true;\n        stream.pause();\n      }\n    });\n    for (var i in stream) {\n      if (util.isFunction(stream[i]) && util.isUndefined(this[i])) {\n        this[i] = function(method) {\n          return function() {\n            return stream[method].apply(stream, arguments);\n          };\n        }(i);\n      }\n    }\n    var events = ['error', 'close', 'destroy', 'pause', 'resume'];\n    forEach(events, function(ev) {\n      stream.on(ev, self.emit.bind(self, ev));\n    });\n    self._read = function(n) {\n      debug('wrapped _read', n);\n      if (paused) {\n        paused = false;\n        stream.resume();\n      }\n    };\n    return self;\n  };\n  Readable._fromList = fromList;\n  function fromList(n, state) {\n    var list = state.buffer;\n    var length = state.length;\n    var stringMode = !!state.decoder;\n    var objectMode = !!state.objectMode;\n    var ret;\n    if (list.length === 0)\n      return null;\n    if (length === 0)\n      ret = null;\n    else if (objectMode)\n      ret = list.shift();\n    else if (!n || n >= length) {\n      if (stringMode)\n        ret = list.join('');\n      else\n        ret = Buffer.concat(list, length);\n      list.length = 0;\n    } else {\n      if (n < list[0].length) {\n        var buf = list[0];\n        ret = buf.slice(0, n);\n        list[0] = buf.slice(n);\n      } else if (n === list[0].length) {\n        ret = list.shift();\n      } else {\n        if (stringMode)\n          ret = '';\n        else\n          ret = new Buffer(n);\n        var c = 0;\n        for (var i = 0,\n            l = list.length; i < l && c < n; i++) {\n          var buf = list[0];\n          var cpy = Math.min(n - c, buf.length);\n          if (stringMode)\n            ret += buf.slice(0, cpy);\n          else\n            buf.copy(ret, c, 0, cpy);\n          if (cpy < buf.length)\n            list[0] = buf.slice(cpy);\n          else\n            list.shift();\n          c += cpy;\n        }\n      }\n    }\n    return ret;\n  }\n  function endReadable(stream) {\n    var state = stream._readableState;\n    if (state.length > 0)\n      throw new Error('endReadable called on non-empty stream');\n    if (!state.endEmitted) {\n      state.ended = true;\n      process.nextTick(function() {\n        if (!state.endEmitted && state.length === 0) {\n          state.endEmitted = true;\n          stream.readable = false;\n          stream.emit('end');\n        }\n      });\n    }\n  }\n  function forEach(xs, f) {\n    for (var i = 0,\n        l = xs.length; i < l; i++) {\n      f(xs[i], i);\n    }\n  }\n  function indexOf(xs, x) {\n    for (var i = 0,\n        l = xs.length; i < l; i++) {\n      if (xs[i] === x)\n        return i;\n    }\n    return -1;\n  }\n})(require('buffer').Buffer, require('process'));\n"]}