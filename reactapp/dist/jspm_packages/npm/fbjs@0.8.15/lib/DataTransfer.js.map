{"version":3,"sources":["../../../../../jspm_packages/npm/fbjs@0.8.15/lib/DataTransfer.js"],"names":["_classCallCheck","instance","Constructor","TypeError","PhotosMimeType","require","createArrayFromMixed","emptyFunction","CR_LF_REGEX","RegExp","LF_ONLY","RICH_TEXT_TYPES","getFileFromDataTransfer","item","kind","getAsFile","DataTransfer","data","types","prototype","isRichText","getHTML","getText","isImage","some","type","text","getData","length","indexOf","replace","isLink","getLink","url","split","items","getFiles","i","getCount","hasOwnProperty","mozItemCount","files","Array","slice","call","map","filter","thatReturnsArgument","hasFiles","module","exports"],"mappings":"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","file":"DataTransfer.js","sourcesContent":["/* */ \n'use strict';\nfunction _classCallCheck(instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n}\nvar PhotosMimeType = require('./PhotosMimeType');\nvar createArrayFromMixed = require('./createArrayFromMixed');\nvar emptyFunction = require('./emptyFunction');\nvar CR_LF_REGEX = new RegExp('\\r\\n', 'g');\nvar LF_ONLY = '\\n';\nvar RICH_TEXT_TYPES = {\n  'text/rtf': 1,\n  'text/html': 1\n};\nfunction getFileFromDataTransfer(item) {\n  if (item.kind == 'file') {\n    return item.getAsFile();\n  }\n}\nvar DataTransfer = function() {\n  function DataTransfer(data) {\n    _classCallCheck(this, DataTransfer);\n    this.data = data;\n    this.types = data.types ? createArrayFromMixed(data.types) : [];\n  }\n  DataTransfer.prototype.isRichText = function isRichText() {\n    if (this.getHTML() && this.getText()) {\n      return true;\n    }\n    if (this.isImage()) {\n      return false;\n    }\n    return this.types.some(function(type) {\n      return RICH_TEXT_TYPES[type];\n    });\n  };\n  DataTransfer.prototype.getText = function getText() {\n    var text;\n    if (this.data.getData) {\n      if (!this.types.length) {\n        text = this.data.getData('Text');\n      } else if (this.types.indexOf('text/plain') != -1) {\n        text = this.data.getData('text/plain');\n      }\n    }\n    return text ? text.replace(CR_LF_REGEX, LF_ONLY) : null;\n  };\n  DataTransfer.prototype.getHTML = function getHTML() {\n    if (this.data.getData) {\n      if (!this.types.length) {\n        return this.data.getData('Text');\n      } else if (this.types.indexOf('text/html') != -1) {\n        return this.data.getData('text/html');\n      }\n    }\n  };\n  DataTransfer.prototype.isLink = function isLink() {\n    return this.types.some(function(type) {\n      return type.indexOf('Url') != -1 || type.indexOf('text/uri-list') != -1 || type.indexOf('text/x-moz-url');\n    });\n  };\n  DataTransfer.prototype.getLink = function getLink() {\n    if (this.data.getData) {\n      if (this.types.indexOf('text/x-moz-url') != -1) {\n        var url = this.data.getData('text/x-moz-url').split('\\n');\n        return url[0];\n      }\n      return this.types.indexOf('text/uri-list') != -1 ? this.data.getData('text/uri-list') : this.data.getData('url');\n    }\n    return null;\n  };\n  DataTransfer.prototype.isImage = function isImage() {\n    var isImage = this.types.some(function(type) {\n      return type.indexOf('application/x-moz-file') != -1;\n    });\n    if (isImage) {\n      return true;\n    }\n    var items = this.getFiles();\n    for (var i = 0; i < items.length; i++) {\n      var type = items[i].type;\n      if (!PhotosMimeType.isImage(type)) {\n        return false;\n      }\n    }\n    return true;\n  };\n  DataTransfer.prototype.getCount = function getCount() {\n    if (this.data.hasOwnProperty('items')) {\n      return this.data.items.length;\n    } else if (this.data.hasOwnProperty('mozItemCount')) {\n      return this.data.mozItemCount;\n    } else if (this.data.files) {\n      return this.data.files.length;\n    }\n    return null;\n  };\n  DataTransfer.prototype.getFiles = function getFiles() {\n    if (this.data.items) {\n      return Array.prototype.slice.call(this.data.items).map(getFileFromDataTransfer).filter(emptyFunction.thatReturnsArgument);\n    } else if (this.data.files) {\n      return Array.prototype.slice.call(this.data.files);\n    } else {\n      return [];\n    }\n  };\n  DataTransfer.prototype.hasFiles = function hasFiles() {\n    return this.getFiles().length > 0;\n  };\n  return DataTransfer;\n}();\nmodule.exports = DataTransfer;\n"]}