{"version":3,"sources":["../../../../../jspm_packages/npm/history@4.7.2/es/createBrowserHistory.js"],"names":["_typeof","Symbol","iterator","obj","constructor","prototype","_extends","Object","assign","target","i","arguments","length","source","key","hasOwnProperty","call","PopStateEvent","HashChangeEvent","getHistoryState","window","history","state","e","createBrowserHistory","props","undefined","globalHistory","canUseHistory","needsHashChangeListener","_props$forceRefresh","forceRefresh","_props$getUserConfirm","getUserConfirmation","_props$keyLength","keyLength","basename","getDOMLocation","historyState","_ref","_window$location","location","pathname","search","hash","path","createKey","Math","random","toString","substr","transitionManager","setState","nextState","notifyListeners","action","handlePopState","event","handlePop","handleHashChange","forceNextPop","confirmTransitionTo","ok","revertPop","fromLocation","toLocation","toIndex","allKeys","indexOf","fromIndex","delta","go","initialLocation","createHref","push","href","pushState","prevIndex","nextKeys","slice","replace","replaceState","n","goBack","goForward","listenerCount","checkDOMListeners","isBlocked","block","prompt","unblock","setPrompt","listen","listener","unlisten","appendListener"],"mappings":"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","file":"createBrowserHistory.js","sourcesContent":["/* */ \n\"format cjs\";\nvar _typeof = typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; };\n\nvar _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; };\n\nimport warning from 'warning';\nimport invariant from 'invariant';\nimport { createLocation } from './LocationUtils';\nimport { addLeadingSlash, stripTrailingSlash, hasBasename, stripBasename, createPath } from './PathUtils';\nimport createTransitionManager from './createTransitionManager';\nimport { canUseDOM, addEventListener, removeEventListener, getConfirmation, supportsHistory, supportsPopStateOnHashChange, isExtraneousPopstateEvent } from './DOMUtils';\n\nvar PopStateEvent = 'popstate';\nvar HashChangeEvent = 'hashchange';\n\nvar getHistoryState = function getHistoryState() {\n  try {\n    return window.history.state || {};\n  } catch (e) {\n    // IE 11 sometimes throws when accessing window.history.state\n    // See https://github.com/ReactTraining/history/pull/289\n    return {};\n  }\n};\n\n/**\n * Creates a history object that uses the HTML5 history API including\n * pushState, replaceState, and the popstate event.\n */\nvar createBrowserHistory = function createBrowserHistory() {\n  var props = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n\n  invariant(canUseDOM, 'Browser history needs a DOM');\n\n  var globalHistory = window.history;\n  var canUseHistory = supportsHistory();\n  var needsHashChangeListener = !supportsPopStateOnHashChange();\n\n  var _props$forceRefresh = props.forceRefresh,\n      forceRefresh = _props$forceRefresh === undefined ? false : _props$forceRefresh,\n      _props$getUserConfirm = props.getUserConfirmation,\n      getUserConfirmation = _props$getUserConfirm === undefined ? getConfirmation : _props$getUserConfirm,\n      _props$keyLength = props.keyLength,\n      keyLength = _props$keyLength === undefined ? 6 : _props$keyLength;\n\n  var basename = props.basename ? stripTrailingSlash(addLeadingSlash(props.basename)) : '';\n\n  var getDOMLocation = function getDOMLocation(historyState) {\n    var _ref = historyState || {},\n        key = _ref.key,\n        state = _ref.state;\n\n    var _window$location = window.location,\n        pathname = _window$location.pathname,\n        search = _window$location.search,\n        hash = _window$location.hash;\n\n\n    var path = pathname + search + hash;\n\n    warning(!basename || hasBasename(path, basename), 'You are attempting to use a basename on a page whose URL path does not begin ' + 'with the basename. Expected path \"' + path + '\" to begin with \"' + basename + '\".');\n\n    if (basename) path = stripBasename(path, basename);\n\n    return createLocation(path, state, key);\n  };\n\n  var createKey = function createKey() {\n    return Math.random().toString(36).substr(2, keyLength);\n  };\n\n  var transitionManager = createTransitionManager();\n\n  var setState = function setState(nextState) {\n    _extends(history, nextState);\n\n    history.length = globalHistory.length;\n\n    transitionManager.notifyListeners(history.location, history.action);\n  };\n\n  var handlePopState = function handlePopState(event) {\n    // Ignore extraneous popstate events in WebKit.\n    if (isExtraneousPopstateEvent(event)) return;\n\n    handlePop(getDOMLocation(event.state));\n  };\n\n  var handleHashChange = function handleHashChange() {\n    handlePop(getDOMLocation(getHistoryState()));\n  };\n\n  var forceNextPop = false;\n\n  var handlePop = function handlePop(location) {\n    if (forceNextPop) {\n      forceNextPop = false;\n      setState();\n    } else {\n      var action = 'POP';\n\n      transitionManager.confirmTransitionTo(location, action, getUserConfirmation, function (ok) {\n        if (ok) {\n          setState({ action: action, location: location });\n        } else {\n          revertPop(location);\n        }\n      });\n    }\n  };\n\n  var revertPop = function revertPop(fromLocation) {\n    var toLocation = history.location;\n\n    // TODO: We could probably make this more reliable by\n    // keeping a list of keys we've seen in sessionStorage.\n    // Instead, we just default to 0 for keys we don't know.\n\n    var toIndex = allKeys.indexOf(toLocation.key);\n\n    if (toIndex === -1) toIndex = 0;\n\n    var fromIndex = allKeys.indexOf(fromLocation.key);\n\n    if (fromIndex === -1) fromIndex = 0;\n\n    var delta = toIndex - fromIndex;\n\n    if (delta) {\n      forceNextPop = true;\n      go(delta);\n    }\n  };\n\n  var initialLocation = getDOMLocation(getHistoryState());\n  var allKeys = [initialLocation.key];\n\n  // Public interface\n\n  var createHref = function createHref(location) {\n    return basename + createPath(location);\n  };\n\n  var push = function push(path, state) {\n    warning(!((typeof path === 'undefined' ? 'undefined' : _typeof(path)) === 'object' && path.state !== undefined && state !== undefined), 'You should avoid providing a 2nd state argument to push when the 1st ' + 'argument is a location-like object that already has state; it is ignored');\n\n    var action = 'PUSH';\n    var location = createLocation(path, state, createKey(), history.location);\n\n    transitionManager.confirmTransitionTo(location, action, getUserConfirmation, function (ok) {\n      if (!ok) return;\n\n      var href = createHref(location);\n      var key = location.key,\n          state = location.state;\n\n\n      if (canUseHistory) {\n        globalHistory.pushState({ key: key, state: state }, null, href);\n\n        if (forceRefresh) {\n          window.location.href = href;\n        } else {\n          var prevIndex = allKeys.indexOf(history.location.key);\n          var nextKeys = allKeys.slice(0, prevIndex === -1 ? 0 : prevIndex + 1);\n\n          nextKeys.push(location.key);\n          allKeys = nextKeys;\n\n          setState({ action: action, location: location });\n        }\n      } else {\n        warning(state === undefined, 'Browser history cannot push state in browsers that do not support HTML5 history');\n\n        window.location.href = href;\n      }\n    });\n  };\n\n  var replace = function replace(path, state) {\n    warning(!((typeof path === 'undefined' ? 'undefined' : _typeof(path)) === 'object' && path.state !== undefined && state !== undefined), 'You should avoid providing a 2nd state argument to replace when the 1st ' + 'argument is a location-like object that already has state; it is ignored');\n\n    var action = 'REPLACE';\n    var location = createLocation(path, state, createKey(), history.location);\n\n    transitionManager.confirmTransitionTo(location, action, getUserConfirmation, function (ok) {\n      if (!ok) return;\n\n      var href = createHref(location);\n      var key = location.key,\n          state = location.state;\n\n\n      if (canUseHistory) {\n        globalHistory.replaceState({ key: key, state: state }, null, href);\n\n        if (forceRefresh) {\n          window.location.replace(href);\n        } else {\n          var prevIndex = allKeys.indexOf(history.location.key);\n\n          if (prevIndex !== -1) allKeys[prevIndex] = location.key;\n\n          setState({ action: action, location: location });\n        }\n      } else {\n        warning(state === undefined, 'Browser history cannot replace state in browsers that do not support HTML5 history');\n\n        window.location.replace(href);\n      }\n    });\n  };\n\n  var go = function go(n) {\n    globalHistory.go(n);\n  };\n\n  var goBack = function goBack() {\n    return go(-1);\n  };\n\n  var goForward = function goForward() {\n    return go(1);\n  };\n\n  var listenerCount = 0;\n\n  var checkDOMListeners = function checkDOMListeners(delta) {\n    listenerCount += delta;\n\n    if (listenerCount === 1) {\n      addEventListener(window, PopStateEvent, handlePopState);\n\n      if (needsHashChangeListener) addEventListener(window, HashChangeEvent, handleHashChange);\n    } else if (listenerCount === 0) {\n      removeEventListener(window, PopStateEvent, handlePopState);\n\n      if (needsHashChangeListener) removeEventListener(window, HashChangeEvent, handleHashChange);\n    }\n  };\n\n  var isBlocked = false;\n\n  var block = function block() {\n    var prompt = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : false;\n\n    var unblock = transitionManager.setPrompt(prompt);\n\n    if (!isBlocked) {\n      checkDOMListeners(1);\n      isBlocked = true;\n    }\n\n    return function () {\n      if (isBlocked) {\n        isBlocked = false;\n        checkDOMListeners(-1);\n      }\n\n      return unblock();\n    };\n  };\n\n  var listen = function listen(listener) {\n    var unlisten = transitionManager.appendListener(listener);\n    checkDOMListeners(1);\n\n    return function () {\n      checkDOMListeners(-1);\n      unlisten();\n    };\n  };\n\n  var history = {\n    length: globalHistory.length,\n    action: 'POP',\n    location: initialLocation,\n    createHref: createHref,\n    push: push,\n    replace: replace,\n    go: go,\n    goBack: goBack,\n    goForward: goForward,\n    block: block,\n    listen: listen\n  };\n\n  return history;\n};\n\nexport default createBrowserHistory;"]}