{"version":3,"sources":["../../../../../jspm_packages/npm/node-fetch@1.7.3/test/server.js"],"names":["http","require","parse","zlib","stream","convert","Multipart","multipart","module","exports","TestServer","server","createServer","router","port","hostname","keepAliveTimeout","on","err","console","log","stack","socket","setTimeout","prototype","start","cb","listen","stop","close","req","res","p","url","pathname","statusCode","setHeader","end","JSON","stringify","name","gzip","buffer","deflate","deflateRaw","write","padding","i","Array","join","destroy","body","c","method","headers","parser","field","part","pipe"],"mappings":"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","file":"server.js","sourcesContent":["/* */ \nvar http = require('http');\nvar parse = require('url').parse;\nvar zlib = require('zlib');\nvar stream = require('stream');\nvar convert = require('encoding').convert;\nvar Multipart = require('parted').multipart;\nmodule.exports = TestServer;\nfunction TestServer() {\n  this.server = http.createServer(this.router);\n  this.port = 30001;\n  this.hostname = 'localhost';\n  this.server.keepAliveTimeout = 1000;\n  this.server.on('error', function(err) {\n    console.log(err.stack);\n  });\n  this.server.on('connection', function(socket) {\n    socket.setTimeout(1500);\n  });\n}\nTestServer.prototype.start = function(cb) {\n  this.server.listen(this.port, this.hostname, cb);\n};\nTestServer.prototype.stop = function(cb) {\n  this.server.close(cb);\n};\nTestServer.prototype.router = function(req, res) {\n  var p = parse(req.url).pathname;\n  if (p === '/hello') {\n    res.statusCode = 200;\n    res.setHeader('Content-Type', 'text/plain');\n    res.end('world');\n  }\n  if (p === '/plain') {\n    res.statusCode = 200;\n    res.setHeader('Content-Type', 'text/plain');\n    res.end('text');\n  }\n  if (p === '/options') {\n    res.statusCode = 200;\n    res.setHeader('Allow', 'GET, HEAD, OPTIONS');\n    res.end('hello world');\n  }\n  if (p === '/html') {\n    res.statusCode = 200;\n    res.setHeader('Content-Type', 'text/html');\n    res.end('<html></html>');\n  }\n  if (p === '/json') {\n    res.statusCode = 200;\n    res.setHeader('Content-Type', 'application/json');\n    res.end(JSON.stringify({name: 'value'}));\n  }\n  if (p === '/gzip') {\n    res.statusCode = 200;\n    res.setHeader('Content-Type', 'text/plain');\n    res.setHeader('Content-Encoding', 'gzip');\n    zlib.gzip('hello world', function(err, buffer) {\n      res.end(buffer);\n    });\n  }\n  if (p === '/deflate') {\n    res.statusCode = 200;\n    res.setHeader('Content-Type', 'text/plain');\n    res.setHeader('Content-Encoding', 'deflate');\n    zlib.deflate('hello world', function(err, buffer) {\n      res.end(buffer);\n    });\n  }\n  if (p === '/deflate-raw') {\n    res.statusCode = 200;\n    res.setHeader('Content-Type', 'text/plain');\n    res.setHeader('Content-Encoding', 'deflate');\n    zlib.deflateRaw('hello world', function(err, buffer) {\n      res.end(buffer);\n    });\n  }\n  if (p === '/sdch') {\n    res.statusCode = 200;\n    res.setHeader('Content-Type', 'text/plain');\n    res.setHeader('Content-Encoding', 'sdch');\n    res.end('fake sdch string');\n  }\n  if (p === '/invalid-content-encoding') {\n    res.statusCode = 200;\n    res.setHeader('Content-Type', 'text/plain');\n    res.setHeader('Content-Encoding', 'gzip');\n    res.end('fake gzip string');\n  }\n  if (p === '/timeout') {\n    setTimeout(function() {\n      res.statusCode = 200;\n      res.setHeader('Content-Type', 'text/plain');\n      res.end('text');\n    }, 1000);\n  }\n  if (p === '/slow') {\n    res.statusCode = 200;\n    res.setHeader('Content-Type', 'text/plain');\n    res.write('test');\n    setTimeout(function() {\n      res.end('test');\n    }, 1000);\n  }\n  if (p === '/cookie') {\n    res.statusCode = 200;\n    res.setHeader('Set-Cookie', ['a=1', 'b=1']);\n    res.end('cookie');\n  }\n  if (p === '/size/chunk') {\n    res.statusCode = 200;\n    res.setHeader('Content-Type', 'text/plain');\n    setTimeout(function() {\n      res.write('test');\n    }, 50);\n    setTimeout(function() {\n      res.end('test');\n    }, 100);\n  }\n  if (p === '/size/long') {\n    res.statusCode = 200;\n    res.setHeader('Content-Type', 'text/plain');\n    res.end('testtest');\n  }\n  if (p === '/encoding/gbk') {\n    res.statusCode = 200;\n    res.setHeader('Content-Type', 'text/html');\n    res.end(convert('<meta charset=\"gbk\"><div>中文</div>', 'gbk'));\n  }\n  if (p === '/encoding/gb2312') {\n    res.statusCode = 200;\n    res.setHeader('Content-Type', 'text/html');\n    res.end(convert('<meta http-equiv=\"Content-Type\" content=\"text/html; charset=gb2312\"><div>中文</div>', 'gb2312'));\n  }\n  if (p === '/encoding/shift-jis') {\n    res.statusCode = 200;\n    res.setHeader('Content-Type', 'text/html; charset=Shift-JIS');\n    res.end(convert('<div>日本語</div>', 'Shift_JIS'));\n  }\n  if (p === '/encoding/euc-jp') {\n    res.statusCode = 200;\n    res.setHeader('Content-Type', 'text/xml');\n    res.end(convert('<?xml version=\"1.0\" encoding=\"EUC-JP\"?><title>日本語</title>', 'EUC-JP'));\n  }\n  if (p === '/encoding/utf8') {\n    res.statusCode = 200;\n    res.end('中文');\n  }\n  if (p === '/encoding/order1') {\n    res.statusCode = 200;\n    res.setHeader('Content-Type', 'charset=gbk; text/plain');\n    res.end(convert('中文', 'gbk'));\n  }\n  if (p === '/encoding/order2') {\n    res.statusCode = 200;\n    res.setHeader('Content-Type', 'text/plain; charset=gbk; qs=1');\n    res.end(convert('中文', 'gbk'));\n  }\n  if (p === '/encoding/chunked') {\n    res.statusCode = 200;\n    res.setHeader('Content-Type', 'text/html');\n    res.setHeader('Transfer-Encoding', 'chunked');\n    var padding = 'a';\n    for (var i = 0; i < 10; i++) {\n      res.write(padding);\n    }\n    res.end(convert('<meta http-equiv=\"Content-Type\" content=\"text/html; charset=Shift_JIS\" /><div>日本語</div>', 'Shift_JIS'));\n  }\n  if (p === '/encoding/invalid') {\n    res.statusCode = 200;\n    res.setHeader('Content-Type', 'text/html');\n    res.setHeader('Transfer-Encoding', 'chunked');\n    var padding = new Array(120 + 1).join('a');\n    for (var i = 0; i < 10; i++) {\n      res.write(padding);\n    }\n    res.end(convert('中文', 'gbk'));\n  }\n  if (p === '/redirect/301') {\n    res.statusCode = 301;\n    res.setHeader('Location', '/inspect');\n    res.end();\n  }\n  if (p === '/redirect/302') {\n    res.statusCode = 302;\n    res.setHeader('Location', '/inspect');\n    res.end();\n  }\n  if (p === '/redirect/303') {\n    res.statusCode = 303;\n    res.setHeader('Location', '/inspect');\n    res.end();\n  }\n  if (p === '/redirect/307') {\n    res.statusCode = 307;\n    res.setHeader('Location', '/inspect');\n    res.end();\n  }\n  if (p === '/redirect/308') {\n    res.statusCode = 308;\n    res.setHeader('Location', '/inspect');\n    res.end();\n  }\n  if (p === '/redirect/chain') {\n    res.statusCode = 301;\n    res.setHeader('Location', '/redirect/301');\n    res.end();\n  }\n  if (p === '/error/redirect') {\n    res.statusCode = 301;\n    res.end();\n  }\n  if (p === '/error/400') {\n    res.statusCode = 400;\n    res.setHeader('Content-Type', 'text/plain');\n    res.end('client error');\n  }\n  if (p === '/error/404') {\n    res.statusCode = 404;\n    res.setHeader('Content-Encoding', 'gzip');\n    res.end();\n  }\n  if (p === '/error/500') {\n    res.statusCode = 500;\n    res.setHeader('Content-Type', 'text/plain');\n    res.end('server error');\n  }\n  if (p === '/error/reset') {\n    res.destroy();\n  }\n  if (p === '/error/json') {\n    res.statusCode = 200;\n    res.setHeader('Content-Type', 'application/json');\n    res.end('invalid json');\n  }\n  if (p === '/no-content') {\n    res.statusCode = 204;\n    res.end();\n  }\n  if (p === '/no-content/gzip') {\n    res.statusCode = 204;\n    res.setHeader('Content-Encoding', 'gzip');\n    res.end();\n  }\n  if (p === '/not-modified') {\n    res.statusCode = 304;\n    res.end();\n  }\n  if (p === '/not-modified/gzip') {\n    res.statusCode = 304;\n    res.setHeader('Content-Encoding', 'gzip');\n    res.end();\n  }\n  if (p === '/inspect') {\n    res.statusCode = 200;\n    res.setHeader('Content-Type', 'application/json');\n    var body = '';\n    req.on('data', function(c) {\n      body += c;\n    });\n    req.on('end', function() {\n      res.end(JSON.stringify({\n        method: req.method,\n        url: req.url,\n        headers: req.headers,\n        body: body\n      }));\n    });\n  }\n  if (p === '/multipart') {\n    res.statusCode = 200;\n    res.setHeader('Content-Type', 'application/json');\n    var parser = new Multipart(req.headers['content-type']);\n    var body = '';\n    parser.on('part', function(field, part) {\n      body += field + '=' + part;\n    });\n    parser.on('end', function() {\n      res.end(JSON.stringify({\n        method: req.method,\n        url: req.url,\n        headers: req.headers,\n        body: body\n      }));\n    });\n    req.pipe(parser);\n  }\n};\n"]}