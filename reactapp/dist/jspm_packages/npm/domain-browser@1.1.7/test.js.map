{"version":3,"sources":["../../../../jspm_packages/npm/domain-browser@1.1.7/test.js"],"names":["events","require","equal","joe","domain","describe","it","done","d","create","on","err","message","run","Error","emitter","EventEmitter","add","emit","domainGotError","setTimeout","remove","bind","a","b","count","intercept"],"mappings":"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","file":"test.js","sourcesContent":["/* */ \n'use strict';\nconst events = require('events');\nconst equal = require('assert-helpers').equal;\nconst joe = require('joe');\nconst domain = require('./index');\njoe.describe('domain-browser', function(describe, it) {\n  it('should work on throws', function(done) {\n    const d = domain.create();\n    d.on('error', function(err) {\n      equal(err && err.message, 'a thrown error', 'error message');\n      done();\n    });\n    d.run(function() {\n      throw new Error('a thrown error');\n    });\n  });\n  it('should be able to add emitters', function(done) {\n    const d = domain.create();\n    const emitter = new events.EventEmitter();\n    d.add(emitter);\n    d.on('error', function(err) {\n      equal(err && err.message, 'an emitted error', 'error message');\n      done();\n    });\n    emitter.emit('error', new Error('an emitted error'));\n  });\n  it('should be able to remove emitters', function(done) {\n    const emitter = new events.EventEmitter();\n    const d = domain.create();\n    let domainGotError = false;\n    d.add(emitter);\n    d.on('error', function(err) {\n      domainGotError = true;\n    });\n    emitter.on('error', function(err) {\n      equal(err && err.message, 'This error should not go to the domain', 'error message');\n      setTimeout(function() {\n        equal(domainGotError, false, 'no domain error');\n        done();\n      }, 0);\n    });\n    d.remove(emitter);\n    emitter.emit('error', new Error('This error should not go to the domain'));\n  });\n  it('bind should work', function(done) {\n    const d = domain.create();\n    d.on('error', function(err) {\n      equal(err && err.message, 'a thrown error', 'error message');\n      done();\n    });\n    d.bind(function(err, a, b) {\n      equal(err && err.message, 'a passed error', 'error message');\n      equal(a, 2, 'value of a');\n      equal(b, 3, 'value of b');\n      throw new Error('a thrown error');\n    })(new Error('a passed error'), 2, 3);\n  });\n  it('intercept should work', function(done) {\n    const d = domain.create();\n    let count = 0;\n    d.on('error', function(err) {\n      if (count === 0) {\n        equal(err && err.message, 'a thrown error', 'error message');\n      } else if (count === 1) {\n        equal(err && err.message, 'a passed error', 'error message');\n        done();\n      }\n      count++;\n    });\n    d.intercept(function(a, b) {\n      equal(a, 2, 'value of a');\n      equal(b, 3, 'value of b');\n      throw new Error('a thrown error');\n    })(null, 2, 3);\n    d.intercept(function(a, b) {\n      throw new Error('should never reach here');\n    })(new Error('a passed error'), 2, 3);\n  });\n});\n"]}