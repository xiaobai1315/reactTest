{"version":3,"sources":["../../../../../jspm_packages/npm/buffer@5.0.7/test/write.js"],"names":["B","require","Buffer","test","isnan","t","b","writeUInt16LE","equal","readUInt16LE","end","writeInt8","buf","throws","writeUInt8","plan","hex","reads","xs","ys","i","length","x","j","y","endianesses","k","z","v1","writefn","val","toString","shift","readfn","undefined","NaN","next","writeUInt32BE","readUInt32BE","writeInt32BE","r","pass","nums","out","fill","newNum","readInt32BE"],"mappings":"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","file":"write.js","sourcesContent":["/* */ \nvar B = require('../index').Buffer;\nvar test = require('tape');\nvar isnan = require('is-nan');\ntest('buffer.write string should get parsed as number', function(t) {\n  var b = new B(64);\n  b.writeUInt16LE('1003', 0);\n  t.equal(b.readUInt16LE(0), 1003);\n  t.end();\n});\ntest('buffer.writeUInt8 a fractional number will get Math.floored', function(t) {\n  var b = new B(1);\n  b.writeInt8(5.5, 0);\n  t.equal(b[0], 5);\n  t.end();\n});\ntest('writeUint8 with a negative number throws', function(t) {\n  var buf = new B(1);\n  t.throws(function() {\n    buf.writeUInt8(-3, 0);\n  });\n  t.end();\n});\ntest('hex of write{Uint,Int}{8,16,32}{LE,BE}', function(t) {\n  t.plan(2 * ((2 * 2 * 2) + 2));\n  var hex = ['03', '0300', '0003', '03000000', '00000003', 'fd', 'fdff', 'fffd', 'fdffffff', 'fffffffd'];\n  var reads = [3, 3, 3, 3, 3, -3, -3, -3, -3, -3];\n  var xs = ['UInt', 'Int'];\n  var ys = [8, 16, 32];\n  for (var i = 0; i < xs.length; i++) {\n    var x = xs[i];\n    for (var j = 0; j < ys.length; j++) {\n      var y = ys[j];\n      var endianesses = (y === 8) ? [''] : ['LE', 'BE'];\n      for (var k = 0; k < endianesses.length; k++) {\n        var z = endianesses[k];\n        var v1 = new B(y / 8);\n        var writefn = 'write' + x + y + z;\n        var val = (x === 'Int') ? -3 : 3;\n        v1[writefn](val, 0);\n        t.equal(v1.toString('hex'), hex.shift());\n        var readfn = 'read' + x + y + z;\n        t.equal(v1[readfn](0), reads.shift());\n      }\n    }\n  }\n  t.end();\n});\ntest('hex of write{Uint,Int}{8,16,32}{LE,BE} with overflow', function(t) {\n  t.plan(3 * ((2 * 2 * 2) + 2));\n  var hex = ['', '03', '00', '030000', '000000', '', 'fd', 'ff', 'fdffff', 'ffffff'];\n  var reads = [undefined, 3, 0, NaN, 0, undefined, 253, -256, 16777213, -256];\n  var xs = ['UInt', 'Int'];\n  var ys = [8, 16, 32];\n  for (var i = 0; i < xs.length; i++) {\n    var x = xs[i];\n    for (var j = 0; j < ys.length; j++) {\n      var y = ys[j];\n      var endianesses = (y === 8) ? [''] : ['LE', 'BE'];\n      for (var k = 0; k < endianesses.length; k++) {\n        var z = endianesses[k];\n        var v1 = new B((y / 8) - 1);\n        var next = new B(4);\n        next.writeUInt32BE(0, 0);\n        var writefn = 'write' + x + y + z;\n        var val = (x === 'Int') ? -3 : 3;\n        v1[writefn](val, 0, true);\n        t.equal(v1.toString('hex'), hex.shift());\n        t.equal(next.readUInt32BE(0), 0);\n        next.writeInt32BE(~0, 0);\n        var readfn = 'read' + x + y + z;\n        var r = reads.shift();\n        if (isnan(r))\n          t.pass('equal');\n        else\n          t.equal(v1[readfn](0, true), r);\n      }\n    }\n  }\n  t.end();\n});\ntest('large values do not improperly roll over (ref #80)', function(t) {\n  var nums = [-25589992, -633756690, -898146932];\n  var out = new B(12);\n  out.fill(0);\n  out.writeInt32BE(nums[0], 0);\n  var newNum = out.readInt32BE(0);\n  t.equal(nums[0], newNum);\n  out.writeInt32BE(nums[1], 4);\n  newNum = out.readInt32BE(4);\n  t.equal(nums[1], newNum);\n  out.writeInt32BE(nums[2], 8);\n  newNum = out.readInt32BE(8);\n  t.equal(nums[2], newNum);\n  t.end();\n});\n"]}