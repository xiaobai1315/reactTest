{"version":3,"sources":["../../../../../jspm_packages/npm/core-js@1.2.7/modules/$.task.js"],"names":["process","ctx","require","invoke","html","cel","global","setTask","setImmediate","clearTask","clearImmediate","MessageChannel","counter","queue","ONREADYSTATECHANGE","defer","channel","port","run","id","hasOwnProperty","fn","listner","event","call","data","args","i","arguments","length","push","Function","nextTick","port2","port1","onmessage","postMessage","addEventListener","importScripts","appendChild","removeChild","setTimeout","module","exports","set","clear"],"mappings":"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","file":"$.task.js","sourcesContent":["/* */ \n(function(process) {\n  var ctx = require('./$.ctx'),\n      invoke = require('./$.invoke'),\n      html = require('./$.html'),\n      cel = require('./$.dom-create'),\n      global = require('./$.global'),\n      process = global.process,\n      setTask = global.setImmediate,\n      clearTask = global.clearImmediate,\n      MessageChannel = global.MessageChannel,\n      counter = 0,\n      queue = {},\n      ONREADYSTATECHANGE = 'onreadystatechange',\n      defer,\n      channel,\n      port;\n  var run = function() {\n    var id = +this;\n    if (queue.hasOwnProperty(id)) {\n      var fn = queue[id];\n      delete queue[id];\n      fn();\n    }\n  };\n  var listner = function(event) {\n    run.call(event.data);\n  };\n  if (!setTask || !clearTask) {\n    setTask = function setImmediate(fn) {\n      var args = [],\n          i = 1;\n      while (arguments.length > i)\n        args.push(arguments[i++]);\n      queue[++counter] = function() {\n        invoke(typeof fn == 'function' ? fn : Function(fn), args);\n      };\n      defer(counter);\n      return counter;\n    };\n    clearTask = function clearImmediate(id) {\n      delete queue[id];\n    };\n    if (require('./$.cof')(process) == 'process') {\n      defer = function(id) {\n        process.nextTick(ctx(run, id, 1));\n      };\n    } else if (MessageChannel) {\n      channel = new MessageChannel;\n      port = channel.port2;\n      channel.port1.onmessage = listner;\n      defer = ctx(port.postMessage, port, 1);\n    } else if (global.addEventListener && typeof postMessage == 'function' && !global.importScripts) {\n      defer = function(id) {\n        global.postMessage(id + '', '*');\n      };\n      global.addEventListener('message', listner, false);\n    } else if (ONREADYSTATECHANGE in cel('script')) {\n      defer = function(id) {\n        html.appendChild(cel('script'))[ONREADYSTATECHANGE] = function() {\n          html.removeChild(this);\n          run.call(id);\n        };\n      };\n    } else {\n      defer = function(id) {\n        setTimeout(ctx(run, id, 1), 0);\n      };\n    }\n  }\n  module.exports = {\n    set: setTask,\n    clear: clearTask\n  };\n})(require('process'));\n"]}