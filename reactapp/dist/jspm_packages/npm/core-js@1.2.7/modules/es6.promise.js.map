{"version":3,"sources":["../../../../../jspm_packages/npm/core-js@1.2.7/modules/es6.promise.js"],"names":["process","$","require","LIBRARY","global","ctx","classof","$export","isObject","anObject","aFunction","strictNew","forOf","setProto","set","same","SPECIES","speciesConstructor","asap","PROMISE","isNode","P","empty","Wrapper","testResolve","sub","test","promise","constructor","exec","resolve","USE_NATIVE","works","P2","x","self","prototype","create","value","then","thenableThenGotten","setDesc","get","e","sameConstructor","a","b","getConstructor","C","S","undefined","isThenable","it","PromiseCapability","reject","$$resolve","$$reject","TypeError","perform","error","notify","record","isReject","n","chain","c","v","ok","s","i","run","reaction","handler","fail","result","h","call","length","setTimeout","p","console","isUnhandled","emit","onunhandledrejection","reason","_d","$reject","d","r","slice","$resolve","wrapper","Promise","executor","err","onFulfilled","onRejected","push","G","W","F","capability","iter","all","iterable","values","abrupt","remaining","results","Array","each","index","alreadyCalled","race"],"mappings":"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","file":"es6.promise.js","sourcesContent":["/* */ \n(function(process) {\n  'use strict';\n  var $ = require('./$'),\n      LIBRARY = require('./$.library'),\n      global = require('./$.global'),\n      ctx = require('./$.ctx'),\n      classof = require('./$.classof'),\n      $export = require('./$.export'),\n      isObject = require('./$.is-object'),\n      anObject = require('./$.an-object'),\n      aFunction = require('./$.a-function'),\n      strictNew = require('./$.strict-new'),\n      forOf = require('./$.for-of'),\n      setProto = require('./$.set-proto').set,\n      same = require('./$.same-value'),\n      SPECIES = require('./$.wks')('species'),\n      speciesConstructor = require('./$.species-constructor'),\n      asap = require('./$.microtask'),\n      PROMISE = 'Promise',\n      process = global.process,\n      isNode = classof(process) == 'process',\n      P = global[PROMISE],\n      empty = function() {},\n      Wrapper;\n  var testResolve = function(sub) {\n    var test = new P(empty),\n        promise;\n    if (sub)\n      test.constructor = function(exec) {\n        exec(empty, empty);\n      };\n    (promise = P.resolve(test))['catch'](empty);\n    return promise === test;\n  };\n  var USE_NATIVE = function() {\n    var works = false;\n    function P2(x) {\n      var self = new P(x);\n      setProto(self, P2.prototype);\n      return self;\n    }\n    try {\n      works = P && P.resolve && testResolve();\n      setProto(P2, P);\n      P2.prototype = $.create(P.prototype, {constructor: {value: P2}});\n      if (!(P2.resolve(5).then(function() {}) instanceof P2)) {\n        works = false;\n      }\n      if (works && require('./$.descriptors')) {\n        var thenableThenGotten = false;\n        P.resolve($.setDesc({}, 'then', {get: function() {\n            thenableThenGotten = true;\n          }}));\n        works = thenableThenGotten;\n      }\n    } catch (e) {\n      works = false;\n    }\n    return works;\n  }();\n  var sameConstructor = function(a, b) {\n    if (LIBRARY && a === P && b === Wrapper)\n      return true;\n    return same(a, b);\n  };\n  var getConstructor = function(C) {\n    var S = anObject(C)[SPECIES];\n    return S != undefined ? S : C;\n  };\n  var isThenable = function(it) {\n    var then;\n    return isObject(it) && typeof(then = it.then) == 'function' ? then : false;\n  };\n  var PromiseCapability = function(C) {\n    var resolve,\n        reject;\n    this.promise = new C(function($$resolve, $$reject) {\n      if (resolve !== undefined || reject !== undefined)\n        throw TypeError('Bad Promise constructor');\n      resolve = $$resolve;\n      reject = $$reject;\n    });\n    this.resolve = aFunction(resolve), this.reject = aFunction(reject);\n  };\n  var perform = function(exec) {\n    try {\n      exec();\n    } catch (e) {\n      return {error: e};\n    }\n  };\n  var notify = function(record, isReject) {\n    if (record.n)\n      return;\n    record.n = true;\n    var chain = record.c;\n    asap(function() {\n      var value = record.v,\n          ok = record.s == 1,\n          i = 0;\n      var run = function(reaction) {\n        var handler = ok ? reaction.ok : reaction.fail,\n            resolve = reaction.resolve,\n            reject = reaction.reject,\n            result,\n            then;\n        try {\n          if (handler) {\n            if (!ok)\n              record.h = true;\n            result = handler === true ? value : handler(value);\n            if (result === reaction.promise) {\n              reject(TypeError('Promise-chain cycle'));\n            } else if (then = isThenable(result)) {\n              then.call(result, resolve, reject);\n            } else\n              resolve(result);\n          } else\n            reject(value);\n        } catch (e) {\n          reject(e);\n        }\n      };\n      while (chain.length > i)\n        run(chain[i++]);\n      chain.length = 0;\n      record.n = false;\n      if (isReject)\n        setTimeout(function() {\n          var promise = record.p,\n              handler,\n              console;\n          if (isUnhandled(promise)) {\n            if (isNode) {\n              process.emit('unhandledRejection', value, promise);\n            } else if (handler = global.onunhandledrejection) {\n              handler({\n                promise: promise,\n                reason: value\n              });\n            } else if ((console = global.console) && console.error) {\n              console.error('Unhandled promise rejection', value);\n            }\n          }\n          record.a = undefined;\n        }, 1);\n    });\n  };\n  var isUnhandled = function(promise) {\n    var record = promise._d,\n        chain = record.a || record.c,\n        i = 0,\n        reaction;\n    if (record.h)\n      return false;\n    while (chain.length > i) {\n      reaction = chain[i++];\n      if (reaction.fail || !isUnhandled(reaction.promise))\n        return false;\n    }\n    return true;\n  };\n  var $reject = function(value) {\n    var record = this;\n    if (record.d)\n      return;\n    record.d = true;\n    record = record.r || record;\n    record.v = value;\n    record.s = 2;\n    record.a = record.c.slice();\n    notify(record, true);\n  };\n  var $resolve = function(value) {\n    var record = this,\n        then;\n    if (record.d)\n      return;\n    record.d = true;\n    record = record.r || record;\n    try {\n      if (record.p === value)\n        throw TypeError(\"Promise can't be resolved itself\");\n      if (then = isThenable(value)) {\n        asap(function() {\n          var wrapper = {\n            r: record,\n            d: false\n          };\n          try {\n            then.call(value, ctx($resolve, wrapper, 1), ctx($reject, wrapper, 1));\n          } catch (e) {\n            $reject.call(wrapper, e);\n          }\n        });\n      } else {\n        record.v = value;\n        record.s = 1;\n        notify(record, false);\n      }\n    } catch (e) {\n      $reject.call({\n        r: record,\n        d: false\n      }, e);\n    }\n  };\n  if (!USE_NATIVE) {\n    P = function Promise(executor) {\n      aFunction(executor);\n      var record = this._d = {\n        p: strictNew(this, P, PROMISE),\n        c: [],\n        a: undefined,\n        s: 0,\n        d: false,\n        v: undefined,\n        h: false,\n        n: false\n      };\n      try {\n        executor(ctx($resolve, record, 1), ctx($reject, record, 1));\n      } catch (err) {\n        $reject.call(record, err);\n      }\n    };\n    require('./$.redefine-all')(P.prototype, {\n      then: function then(onFulfilled, onRejected) {\n        var reaction = new PromiseCapability(speciesConstructor(this, P)),\n            promise = reaction.promise,\n            record = this._d;\n        reaction.ok = typeof onFulfilled == 'function' ? onFulfilled : true;\n        reaction.fail = typeof onRejected == 'function' && onRejected;\n        record.c.push(reaction);\n        if (record.a)\n          record.a.push(reaction);\n        if (record.s)\n          notify(record, false);\n        return promise;\n      },\n      'catch': function(onRejected) {\n        return this.then(undefined, onRejected);\n      }\n    });\n  }\n  $export($export.G + $export.W + $export.F * !USE_NATIVE, {Promise: P});\n  require('./$.set-to-string-tag')(P, PROMISE);\n  require('./$.set-species')(PROMISE);\n  Wrapper = require('./$.core')[PROMISE];\n  $export($export.S + $export.F * !USE_NATIVE, PROMISE, {reject: function reject(r) {\n      var capability = new PromiseCapability(this),\n          $$reject = capability.reject;\n      $$reject(r);\n      return capability.promise;\n    }});\n  $export($export.S + $export.F * (!USE_NATIVE || testResolve(true)), PROMISE, {resolve: function resolve(x) {\n      if (x instanceof P && sameConstructor(x.constructor, this))\n        return x;\n      var capability = new PromiseCapability(this),\n          $$resolve = capability.resolve;\n      $$resolve(x);\n      return capability.promise;\n    }});\n  $export($export.S + $export.F * !(USE_NATIVE && require('./$.iter-detect')(function(iter) {\n    P.all(iter)['catch'](function() {});\n  })), PROMISE, {\n    all: function all(iterable) {\n      var C = getConstructor(this),\n          capability = new PromiseCapability(C),\n          resolve = capability.resolve,\n          reject = capability.reject,\n          values = [];\n      var abrupt = perform(function() {\n        forOf(iterable, false, values.push, values);\n        var remaining = values.length,\n            results = Array(remaining);\n        if (remaining)\n          $.each.call(values, function(promise, index) {\n            var alreadyCalled = false;\n            C.resolve(promise).then(function(value) {\n              if (alreadyCalled)\n                return;\n              alreadyCalled = true;\n              results[index] = value;\n              --remaining || resolve(results);\n            }, reject);\n          });\n        else\n          resolve(results);\n      });\n      if (abrupt)\n        reject(abrupt.error);\n      return capability.promise;\n    },\n    race: function race(iterable) {\n      var C = getConstructor(this),\n          capability = new PromiseCapability(C),\n          reject = capability.reject;\n      var abrupt = perform(function() {\n        forOf(iterable, false, function(promise) {\n          C.resolve(promise).then(capability.resolve, reject);\n        });\n      });\n      if (abrupt)\n        reject(abrupt.error);\n      return capability.promise;\n    }\n  });\n})(require('process'));\n"]}