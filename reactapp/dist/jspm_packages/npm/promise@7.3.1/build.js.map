{"version":3,"sources":["../../../../jspm_packages/npm/promise@7.3.1/build.js"],"names":["fs","require","rimraf","acorn","walk","ids","names","getIdFor","name","id","Math","floor","random","indexOf","push","fixup","src","ast","parse","split","simple","MemberExpression","node","computed","property","type","replace","source","slice","start","end","join","str","i","sync","__dirname","mkdirSync","readdirSync","forEach","filename","readFileSync","out","writeFileSync"],"mappings":"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","file":"build.js","sourcesContent":["/* */ \n'use strict';\nvar fs = require('fs');\nvar rimraf = require('rimraf');\nvar acorn = require('acorn');\nvar walk = require('acorn/dist/walk');\nvar ids = [];\nvar names = {};\nfunction getIdFor(name) {\n  if (name in names)\n    return names[name];\n  var id;\n  do {\n    id = '_' + Math.floor(Math.random() * 100);\n  } while (ids.indexOf(id) !== -1);\n  ids.push(id);\n  names[name] = id;\n  return id;\n}\nfunction fixup(src) {\n  var ast = acorn.parse(src);\n  src = src.split('');\n  walk.simple(ast, {MemberExpression: function(node) {\n      if (node.computed)\n        return;\n      if (node.property.type !== 'Identifier')\n        return;\n      if (node.property.name[0] !== '_')\n        return;\n      replace(node.property, getIdFor(node.property.name));\n    }});\n  function source(node) {\n    return src.slice(node.start, node.end).join('');\n  }\n  function replace(node, str) {\n    for (var i = node.start; i < node.end; i++) {\n      src[i] = '';\n    }\n    src[node.start] = str;\n  }\n  return src.join('');\n}\nrimraf.sync(__dirname + '/lib/');\nfs.mkdirSync(__dirname + '/lib/');\nfs.readdirSync(__dirname + '/src').forEach(function(filename) {\n  var src = fs.readFileSync(__dirname + '/src/' + filename, 'utf8');\n  var out = fixup(src);\n  fs.writeFileSync(__dirname + '/lib/' + filename, out);\n});\nrimraf.sync(__dirname + '/domains/');\nfs.mkdirSync(__dirname + '/domains/');\nfs.readdirSync(__dirname + '/src').forEach(function(filename) {\n  var src = fs.readFileSync(__dirname + '/src/' + filename, 'utf8');\n  var out = fixup(src);\n  out = out.replace(/require\\(\\'asap\\/raw\\'\\)/g, \"require('asap')\");\n  fs.writeFileSync(__dirname + '/domains/' + filename, out);\n});\nrimraf.sync(__dirname + '/setimmediate/');\nfs.mkdirSync(__dirname + '/setimmediate/');\nfs.readdirSync(__dirname + '/src').forEach(function(filename) {\n  var src = fs.readFileSync(__dirname + '/src/' + filename, 'utf8');\n  var out = fixup(src);\n  out = out.replace(/var asap \\= require\\(\\'([a-z\\/]+)\\'\\);/g, '');\n  out = out.replace(/asap/g, \"setImmediate\");\n  fs.writeFileSync(__dirname + '/setimmediate/' + filename, out);\n});\n"]}